[
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "参考文献",
    "section": "",
    "text": "https://www.nature.com/articles/s41467-023-43462-1\n\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "热图.html",
    "href": "热图.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All CodeView Source\n1 热图\n\nCodelibrary(pheatmap)\n# Create test matrix\ntest = matrix(rnorm(200), 20, 10)\ntest[1:10, seq(1, 10, 2)] = test[1:10, seq(1, 10, 2)] + 3\ntest[11:20, seq(2, 10, 2)] = test[11:20, seq(2, 10, 2)] + 2\ntest[15:20, seq(2, 10, 2)] = test[15:20, seq(2, 10, 2)] + 4\ncolnames(test) = paste(\"Test\", 1:10, sep = \"\")\nrownames(test) = paste(\"Gene\", 1:20, sep = \"\")\n\n\n\nCodetest\n#&gt;             Test1       Test2      Test3      Test4        Test5       Test6\n#&gt; Gene1   3.4429287  0.97405676  4.4357834  0.3224788  3.959653579  1.14771717\n#&gt; Gene2   3.2006674  0.11792875  1.4613751 -0.3849059  3.972309541  0.21047603\n#&gt; Gene3   4.4601198 -0.92312466  2.2693426  2.3718886  3.527453479  0.19021533\n#&gt; Gene4   1.2339105  1.61637157  3.3082871  1.6525814  2.022342854 -1.62034772\n#&gt; Gene5   2.1790582 -0.37872955  2.3858200 -2.8125301  4.133458727  1.81255543\n#&gt; Gene6   4.0014729 -0.58928840  4.6946429  0.1351052  1.371960602 -0.47986004\n#&gt; Gene7   3.1310768  2.26505523  1.4143726 -1.1725723  3.137056932 -0.33857356\n#&gt; Gene8   3.9210966 -0.02104079  2.6191355 -1.1113537  2.808879071 -1.20645174\n#&gt; Gene9   1.4902268  0.02593187  2.5762583 -1.5707492  3.452050096  0.47056390\n#&gt; Gene10  2.5231877 -0.24959168  3.2765207 -0.4759022  3.065790132 -0.07679065\n#&gt; Gene11  0.2730204  1.75662086  0.3661200  1.5016415 -0.008315358  1.84471034\n#&gt; Gene12  0.2946029  1.18322890  0.1872870  1.9551928  0.353299521  2.10969009\n#&gt; Gene13  0.6865864  0.92681840 -0.8363160  1.4949443  1.648903005  0.21834474\n#&gt; Gene14 -1.7751972  1.85028821 -0.1170845  1.2013545  1.772732621  1.40894900\n#&gt; Gene15  2.2055143  7.08885824 -0.4118041  6.8509326  0.106857695  5.96867879\n#&gt; Gene16 -0.5149111  6.66884291  0.6210717  6.9276024 -0.156758374  5.47149137\n#&gt; Gene17  0.1184209  6.84360528  0.3228722  5.3388866 -0.204087286  5.71306137\n#&gt; Gene18  0.2712415  7.47089835 -0.5530883  6.7712328  0.513814900  6.75025222\n#&gt; Gene19 -0.3862120  7.79844094  1.7250137  7.2911434  0.392667376  5.17807221\n#&gt; Gene20 -0.3521003  5.26787733 -0.4620397  5.6257023  0.259966705  9.11870360\n#&gt;              Test7       Test8       Test9     Test10\n#&gt; Gene1   3.55278268  0.77783277  2.69556033 0.12434258\n#&gt; Gene2   1.32566370  0.64811005  2.65979759 0.49321818\n#&gt; Gene3   1.90071574 -1.72052558  3.09946291 1.16979871\n#&gt; Gene4   3.02590057 -0.49874749  3.22199163 0.10592553\n#&gt; Gene5   2.89754882 -0.74640156  3.71248979 1.58454848\n#&gt; Gene6   3.60403948  1.29662642  3.20302114 0.47687989\n#&gt; Gene7   2.81893328 -2.61783937  4.85635818 0.34450700\n#&gt; Gene8   3.23926747 -0.03240268  3.70624294 0.13425822\n#&gt; Gene9   2.77659865 -1.99306256  4.84294633 0.97029484\n#&gt; Gene10  4.48264354  0.05895736  4.58244657 0.73559433\n#&gt; Gene11  0.79063808  2.13441751 -0.56382416 3.75244276\n#&gt; Gene12 -0.28802340  2.07276987  0.88947200 0.07798976\n#&gt; Gene13 -0.64628474  1.99340902  0.40449498 3.02254604\n#&gt; Gene14  1.24217340  2.64211001 -0.32139575 0.27588277\n#&gt; Gene15  0.32833567  7.16146277 -0.28005237 5.29992640\n#&gt; Gene16  0.36071925  4.67268287 -0.66359345 6.26553038\n#&gt; Gene17  0.32881496  6.15327226 -0.25939992 5.34586280\n#&gt; Gene18  0.15711300  6.51436728 -0.07801119 4.02704338\n#&gt; Gene19 -0.01190601  5.22954415 -1.24704802 6.15167940\n#&gt; Gene20 -1.06109607  4.49946035  1.07306571 4.95438164\n\n\n\nCodeannotation_col = data.frame(type=c(rep(\"normal\",5),rep(\"tumor\",5)))\nrownames(annotation_col) &lt;- colnames(test)\nanno_colors &lt;- list(type=c(normal=\"#1b9e77\",tumor=\"#d95f02\"))\n\npheatmap(test,show_rownames = T,show_colnames = F,cluster_rows = F,treeheight_col = 5,display_numbers = T,\n         gaps_col = 5,annotation_col = annotation_col,annotation_colors = anno_colors,annotation_legend = \n             F)\n\n\n\n\n\n\n\n均一化z-score\n\nCodepheatmap(test,scale = \"column\",border_color = \"green\",fontsize = 8)\n\n\n\n\n\n\n\n\nCodepheatmap(test,scale = \"row\",border_color = NA,color = colorRampPalette(c(\"blue\",\"white\",\"red\"))(200))\n\n\n\n\n\n\n\n\nCodelibrary(ComplexHeatmap)\n#&gt; Loading required package: grid\n#&gt; ========================================\n#&gt; ComplexHeatmap version 2.20.0\n#&gt; Bioconductor page: http://bioconductor.org/packages/ComplexHeatmap/\n#&gt; Github page: https://github.com/jokergoo/ComplexHeatmap\n#&gt; Documentation: http://jokergoo.github.io/ComplexHeatmap-reference\n#&gt; \n#&gt; If you use it in published research, please cite either one:\n#&gt; - Gu, Z. Complex Heatmap Visualization. iMeta 2022.\n#&gt; - Gu, Z. Complex heatmaps reveal patterns and correlations in multidimensional \n#&gt;     genomic data. Bioinformatics 2016.\n#&gt; \n#&gt; \n#&gt; The new InteractiveComplexHeatmap package can directly export static \n#&gt; complex heatmaps into an interactive Shiny app with zero effort. Have a try!\n#&gt; \n#&gt; This message can be suppressed by:\n#&gt;   suppressPackageStartupMessages(library(ComplexHeatmap))\n#&gt; ========================================\n#&gt; ! pheatmap() has been masked by ComplexHeatmap::pheatmap(). Most of the arguments\n#&gt;    in the original pheatmap() are identically supported in the new function. You \n#&gt;    can still use the original function by explicitly calling pheatmap::pheatmap().\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "图",
      "热图"
    ]
  },
  {
    "objectID": "Graph.html",
    "href": "Graph.html",
    "title": "",
    "section": "",
    "text": "Code\n\n\n\n\n\n图\n分组条图添加显著性，误差棒\n分组排序条图\n生存曲线\n回归曲线\n十六进制取色\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "图"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "",
    "section": "",
    "text": "Code\n\n\n\n\n这是R实现关于 articles 的图表的记录。\n作为速查电子笔记\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "01.html",
    "href": "01.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "图",
      "01"
    ]
  },
  {
    "objectID": "01.html#waterfall-barplotfig.1-c",
    "href": "01.html#waterfall-barplotfig.1-c",
    "title": "",
    "section": "\n1.1 waterfall barplot：Fig.1 c",
    "text": "1.1 waterfall barplot：Fig.1 c\n\nCodec &lt;- read_excel(\"data/01source.xlsx\",sheet=1,range = \"A2:D16\") |&gt; \n  rename(\n    LR_DPVB=`LR-DPVB`\n  )  |&gt; \n  pivot_longer(\n    cols = CON:LR_DPVB,\n    names_to = \"treatment\",\n    values_to = \"changerate\"\n  ) |&gt; \n  mutate(\n    treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB')),\n    changerate=if_else(changerate&gt;=1,100,changerate*100)\n  ) |&gt; \n  arrange(treatment)|&gt;\n  drop_na() |&gt; \n  mutate(\n    id=1:52\n    ) \n\n\n\nCode\nggplot( c ,aes(x=id,y=changerate,fill=treatment))+ \n  geom_bar(stat = \"identity\",position = \"dodge\",width =0.8)+\n#  scale_fill_lancet()+\n#  scale_fill_nejm()+\n#  scale_fill_jama()+\n    scale_fill_jco()+\n    scale_y_continuous(name = \"MRI tumor volume change from baseline (%)\",\n                       limits = c(-100,100),\n                       breaks = seq(-100,100,50),\n                       )+\n    theme_pubr()+\n    theme(\n        legend.position = c(0.8,0.8),\n        legend.title = element_blank(),\n        axis.title.x = element_blank(),\n        axis.text.x = element_blank(),\n        axis.ticks.x = element_blank(),\n        axis.line.x = element_blank(),\n        plot.title = element_text(hjust = 0.5),\n    )+\n    ggtitle(\"Hepa1-6 tumor\")+\n    geom_hline(yintercept = 0,color = \"black\",linetype =1,linewidth=0.8)+\n    geom_hline(yintercept=c(20,-30), colour=\"gray15\", linetype=3,linewidth=0.8)+                # 0 = blank, 1 = solid, 2 = dashed, 3 = dotted, \n            # 4 = dotdash, 5 = longdash, 6 = twodash\n    annotate(geom = \"text\",x=c(2,50),y=c(-30,20),\n             label = c(\"PR:-30%\",\"PD:20%\"),\n             vjust = -0.5,\n             )   \n#&gt; Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2\n#&gt; 3.5.0.\n#&gt; ℹ Please use the `legend.position.inside` argument of `theme()` instead.",
    "crumbs": [
      "图",
      "01"
    ]
  },
  {
    "objectID": "01.html#生存曲线-kaplan-meier-curvefig.1-dn",
    "href": "01.html#生存曲线-kaplan-meier-curvefig.1-dn",
    "title": "",
    "section": "\n1.2 生存曲线 Kaplan-Meier curve：Fig.1 d、n",
    "text": "1.2 生存曲线 Kaplan-Meier curve：Fig.1 d、n\n\nCode### 数据 三列 “group”分组列， “time”生存时间列，“status”事件状态列\nd&lt;-read_excel(\"data/01source.xlsx\",sheet=1,range = \"A19:E75\") |&gt; \n  rename(\n    LR_DPVB=`LR-DPVB`\n  )  |&gt; \n  pivot_longer(\n    cols = CON:LR_DPVB,\n    names_to = \"treatment\",\n    values_to = \"status\"\n  ) |&gt; drop_na() |&gt; \n  mutate(\n    treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB'))\n  )\n# 加载包\nlibrary(survival)\n\n# 使用 Kaplan-Meier 方法拟合生存曲线\nkm_fit&lt;-survfit(Surv(Days,status)~treatment,data=d)\nsummary(km_fit,data=d)\n#&gt; Call: survfit(formula = Surv(Days, status) ~ treatment, data = d)\n#&gt; \n#&gt;                 treatment=CON \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    11     14       1   0.9286  0.0688       0.8030        1.000\n#&gt;    13     13       1   0.8571  0.0935       0.6921        1.000\n#&gt;    14     12       2   0.7143  0.1207       0.5129        0.995\n#&gt;    15     10       1   0.6429  0.1281       0.4351        0.950\n#&gt;    17      9       3   0.4286  0.1323       0.2341        0.785\n#&gt;    20      6       2   0.2857  0.1207       0.1248        0.654\n#&gt;    21      4       2   0.1429  0.0935       0.0396        0.515\n#&gt;    25      2       1   0.0714  0.0688       0.0108        0.472\n#&gt;    27      1       1   0.0000     NaN           NA           NA\n#&gt; \n#&gt;                 treatment=LDRT \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    13     14       2   0.8571  0.0935       0.6921        1.000\n#&gt;    15     12       1   0.7857  0.1097       0.5977        1.000\n#&gt;    16     11       1   0.7143  0.1207       0.5129        0.995\n#&gt;    18     10       1   0.6429  0.1281       0.4351        0.950\n#&gt;    19      9       2   0.5000  0.1336       0.2961        0.844\n#&gt;    20      7       3   0.2857  0.1207       0.1248        0.654\n#&gt;    24      4       1   0.2143  0.1097       0.0786        0.584\n#&gt;    25      3       1   0.1429  0.0935       0.0396        0.515\n#&gt;    27      2       1   0.0714  0.0688       0.0108        0.472\n#&gt;    30      1       1   0.0000     NaN           NA           NA\n#&gt; \n#&gt;                 treatment=DPVB \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    20     14       1    0.929  0.0688        0.803        1.000\n#&gt;    23     13       1    0.857  0.0935        0.692        1.000\n#&gt;    27     12       1    0.786  0.1097        0.598        1.000\n#&gt;    28     11       1    0.714  0.1207        0.513        0.995\n#&gt;    30     10       1    0.643  0.1281        0.435        0.950\n#&gt;    32      9       1    0.571  0.1323        0.363        0.899\n#&gt;    38      8       1    0.500  0.1336        0.296        0.844\n#&gt;    39      7       1    0.429  0.1323        0.234        0.785\n#&gt;    45      6       1    0.357  0.1281        0.177        0.721\n#&gt; \n#&gt;                 treatment=LR_DPVB \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    30     14       1    0.929  0.0688        0.803            1\n#&gt;    40     13       1    0.857  0.0935        0.692            1\n\n\n\nCodeplot(km_fit,\n     lty = 1,\n     col = c(\"gray\",\"blue\",\"orange3\",\"darkred\"),\n     lwd = 2,\n     )\n\n\n\n\n\n\n\n\nCode# 使用 ggplot2 和 survminer 绘制生存曲线图\nlibrary(survminer)\nggsurvplot(\n    fit  = km_fit,\n    data = d,\n    fun = \"pct\",  #event',累计死亡比列，'cumhaz':cumulative hazard累计风险\n    \n    palette = \"jco\",\n    linetype = c(1,5,4,6),\n    surv.median.line = 'none',\n    \n    conf.int = TRUE,\n    conf.int.alpha=0.5,\n    \n    pval = TRUE,# \"log rank p=0.0053\"\n    log.rank.weights='1',  \n    pval.method = TRUE,\n    pval.coord=c(40,75),\n    pval.method.coord=c(35,75),\n\n    risk.table = \"abs_pct\", # \"nrisk_cumcensor\" and \"nrisk_cumevents\"\n    risk.table.col = \"treatment\",\n    tables.theme = theme_cleantable(),\n    ncensor.plot=T,\n    \n    \n    axes.offset=F,  #(0,0)pos\n    title = \"Hepa1-6 tumor\",\n    xlab=\"Days\",\n    ylab=\"Percent survival (%)\",\n    \n    legend.title = \"\",\n    legend = c(0.2,0.25),\n    legend.labs=c('CON','LDRT','DPVB','LR_DPVB'),\n    \n    ggtheme = theme_survminer(),\n    )",
    "crumbs": [
      "图",
      "01"
    ]
  },
  {
    "objectID": "01.html#条形图-errorbar-significance-dotplotfig.1-ghjp",
    "href": "01.html#条形图-errorbar-significance-dotplotfig.1-ghjp",
    "title": "",
    "section": "\n1.3 条形图+ errorbar + significance + dotplot：Fig.1 g、h、j、p",
    "text": "1.3 条形图+ errorbar + significance + dotplot：Fig.1 g、h、j、p\n\nCodeg&lt;-read_excel(\"data/01source.xlsx\",sheet=1,range=\"G2:Z3\") \n#&gt; New names:\n#&gt; • `` -&gt; `...2`\n#&gt; • `` -&gt; `...3`\n#&gt; • `` -&gt; `...4`\n#&gt; • `` -&gt; `...5`\n#&gt; • `` -&gt; `...7`\n#&gt; • `` -&gt; `...8`\n#&gt; • `` -&gt; `...9`\n#&gt; • `` -&gt; `...10`\n#&gt; • `` -&gt; `...12`\n#&gt; • `` -&gt; `...13`\n#&gt; • `` -&gt; `...14`\n#&gt; • `` -&gt; `...15`\n#&gt; • `` -&gt; `...17`\n#&gt; • `` -&gt; `...18`\n#&gt; • `` -&gt; `...19`\n#&gt; • `` -&gt; `...20`\ncolnames(g) &lt;- rep(c('CON','LDRT','DPVB','LR_DPVB'),each=5)\ng&lt;- g |&gt;  pivot_longer(\n  cols = everything(),\n  names_to = \"treatment\",\n  values_to = \"liverweight\"\n  )|&gt; \n  mutate(\n    treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB'))\n  )\ng\n#&gt; # A tibble: 20 × 2\n#&gt;    treatment liverweight\n#&gt;    &lt;fct&gt;           &lt;dbl&gt;\n#&gt;  1 CON              1.75\n#&gt;  2 CON              1.8 \n#&gt;  3 CON              2.01\n#&gt;  4 CON              1.52\n#&gt;  5 CON              1.63\n#&gt;  6 LDRT             1.73\n#&gt;  7 LDRT             2.05\n#&gt;  8 LDRT             1.48\n#&gt;  9 LDRT             1.66\n#&gt; 10 LDRT             1.68\n#&gt; 11 DPVB             1.2 \n#&gt; 12 DPVB             1.38\n#&gt; 13 DPVB             1.52\n#&gt; 14 DPVB             1.62\n#&gt; 15 DPVB             1.39\n#&gt; 16 LR_DPVB          1.2 \n#&gt; 17 LR_DPVB          1.23\n#&gt; 18 LR_DPVB          1.13\n#&gt; 19 LR_DPVB          1.03\n#&gt; 20 LR_DPVB          0.89\n\n\n\nCodesource(\"function/calculate_t_tests.R\")\ncalculate_t_tests(g,\"treatment\",\"liverweight\")\n#&gt;                  CON         LDRT        DPVB LR_DPVB\n#&gt; CON               NA           NA          NA      NA\n#&gt; LDRT    0.8639404014           NA          NA      NA\n#&gt; DPVB    0.0193695457 0.0359059495          NA      NA\n#&gt; LR_DPVB 0.0003376202 0.0008265681 0.008820249      NA\n\n\n\n\n\n\n\n\nNote\n\n\n\n函数calculate_t_tests\n\nCode# 定义计算两两组之间t检验的函数\ncalculate_t_tests &lt;- function(data, group_by, value_column) {\n  # data: 数据框\n  # group_by: 组别的列名\n  # value_column: 要比较的数值的列名\n  \n  # 提取唯一的组别\n  groups &lt;- unique(data[[group_by]])\n  \n  # 初始化结果矩阵\n  result_matrix &lt;- matrix(NA, nrow = length(groups), ncol = length(groups),\n                          dimnames = list(groups, groups))\n  \n  # 循环遍历所有可能的组合\n  for (i in 1:(length(groups)-1)) {\n    for (j in (i+1):length(groups)) {\n      # 提取两组数据\n      group1_data &lt;- data[data[[group_by]] == groups[i], value_column]\n      group2_data &lt;- data[data[[group_by]] == groups[j], value_column]\n      \n      # 执行t检验\n      t_test_result &lt;- t.test(group1_data, group2_data)\n      \n      # 提取p值\n      p_value &lt;- t_test_result$p.value\n      \n      # 将p值存入结果矩阵\n      #result_matrix[groups[i], groups[j]] &lt;- p_value\n      result_matrix[groups[j], groups[i]] &lt;- p_value\n    }\n  }\n  \n  # 返回结果矩阵\n  return(result_matrix)\n}\n\n\n\n\n\n1.3.1 1\n\nCodelibrary(ggpubr)\nggbarplot(data = g,\n          x=\"treatment\",y=\"liverweight\",\n          add = c(\"mean_sd\"),\n          fill = \"treatment\",\n          palette = \"jco\",\n          title = \"DEN+CCl4 tumor\",\n          xlab = \"\",\n          ylab='liver weight (g)',\n          legend='none',\n          )+\n  stat_compare_means(\n      #aes(label='p.format'),\n      comparisons = list(c('CON','LDRT'),c(\"DPVB\",'LR_DPVB'), c(\"CON\",\"LR_DPVB\")),\n      method = 't.test',\n      tip.length = c(0,0,0,0,0,0),\n      bracket.size = 1,linewidth=1)+\n\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.text.x = element_text(angle = 45,vjust = 0.5))+\n  geom_dotplot(data = g,\n               mapping=aes(x=treatment,y=liverweight),\n               binaxis = 'y',stackdir = 'center',binwidth = 0.05)\n\n\n\n\n\n\n\n\n1.3.2 2\n\nCodelibrary(ggsignif)\ng |&gt; \n  summarise(\n    n=n(),\n    mean=mean(liverweight),\n    sd=sd(liverweight),\n    .by=treatment\n  ) |&gt; \n    ggplot(aes(treatment,mean,fill=treatment))+\n    geom_bar(stat = \"identity\",width = .7,position = position_dodge())+#条形图\n    geom_errorbar(aes(ymin=mean-sd,ymax=mean+sd),\n                  width=.2,color=\"black\",linewidth=.8)+#误差棒\n    geom_signif(data = g,\n              mapping=aes(x=treatment,y=liverweight),\n              comparisons = list(c('CON','LDRT'),c(\"DPVB\",'LR_DPVB'),\n                                 c(\"CON\",\"LR_DPVB\")),\n              annotations = c(\"p=0.8639\",\"p=0.0088\",\"p=0.00034\"),\n              map_signif_level=F,\n              tip_length=c(0.0,0.0,0.0,0.0,0.0,0.0),\n              y_position=c(2.1,1.8,2.35),size = .8,\n              textsize = 5,\n              test = \"t.test\"\n              )+\n    theme_pubr()+\n    scale_fill_jco()+\n    scale_y_continuous(limits = c(0,2.5))+\n    labs(\n        x='',\n        y='liver weight (g)',\n        title=\"DEN+CCl4 tumor\"\n    )+\n    theme(\n        plot.title = element_text(hjust =0.5 ),\n        legend.position = 'none',\n        axis.text.x = element_text(angle = 45,vjust = .5)\n    )+  \n    geom_dotplot(data = g,\n                 mapping=aes(x=treatment,y=liverweight),\n                 binaxis = 'y',\n                 stackdir = 'center',#居中\n                 fill='black',\n                 binwidth = 0.05)\n#&gt; Warning in geom_signif(data = g, mapping = aes(x = treatment, y = liverweight),\n#&gt; : You have set data and mapping, are you sure that manual = FALSE is correct?\n\n\n\n\n\n\n\n\n1.3.3 3\n\nCodeggplot(g,aes(x=treatment,y=liverweight))+ \n    \n    geom_bar(aes(fill=treatment),\n           stat = 'summary',fun=mean,\n           position = position_dodge(),width = .7) +\n    \n    stat_summary(fun.data = 'mean_sd',geom=\"errorbar\",width=.2,linewidth=1) +\n    \n    geom_signif(comparisons = list(c('CON','LDRT'),c(\"DPVB\",'LR_DPVB'),\n                                 c(\"CON\",\"LR_DPVB\")),\n                map_signif_level=F,\n                tip_length=c(0,0,0,0,0,0),\n                y_position=c(2.1,1.8,2.35),size = 0.8,\n                test = \"t.test\",textsize = 5,\n  )+\n    geom_dotplot(data = g,\n                 mapping=aes(x=treatment,y=liverweight),\n                 binaxis = 'y',\n                 stackdir = 'center',#居中\n                 fill='black',\n                 binwidth = 0.05)+\n    theme_pubr()+\n    scale_fill_jco()+\n    scale_y_continuous(limits = c(0,2.5))+\n    labs(\n        x='',\n        y='liver weight (g)',\n        title=\"DEN+CCl4 tumor\"\n    )+\n    theme(\n        plot.title = element_text(hjust =0.5 ),\n        legend.position = 'none',\n        axis.text.x = element_text(angle = 45,vjust = .5)\n    )\n\n\n\n\n\n\n\n\n1.3.4 4 分组并列，组内显著性p值\nhttps://www.datanovia.com/en/blog/tag/ggpubr/\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/\n\nCodef2e &lt;- read_excel(\"data/01source.xlsx\", sheet = 3, range = \"A2:M4\")\n#&gt; New names:\n#&gt; • `` -&gt; `...3`\n#&gt; • `` -&gt; `...4`\n#&gt; • `` -&gt; `...6`\n#&gt; • `` -&gt; `...7`\n#&gt; • `` -&gt; `...9`\n#&gt; • `` -&gt; `...10`\n#&gt; • `` -&gt; `...12`\n#&gt; • `` -&gt; `...13`\ncolnames(f2e) &lt;-\n    c(\"type\", rep(c('CON', 'LDRT', 'DPVB', 'LR_DPVB'), each = 3))\n\nf2e |&gt; pivot_longer(cols = -1,\n                    names_to = \"trt\",\n                    values_to = \"pct\",\n) |&gt;\n    mutate(trt = factor(trt, levels = c('CON', 'LDRT', 'DPVB', 'LR_DPVB'))) -&gt; f2e\n\n\n\nCodelibrary(ggpubr)\nlibrary(rstatix)\n\nstat.test &lt;- f2e %&gt;%\n  group_by(type) %&gt;%\n  t_test(pct ~ trt) |&gt; \n  adjust_pvalue(method = \"bonferroni\") %&gt;%\n    add_significance(\"p.adj\") |&gt; \n    add_significance(\"p\") \n\n\nstat.test &lt;- stat.test %&gt;%\n  add_xy_position(fun = \"mean_sd\", x = \"type\", dodge = 1)|&gt; \n  dplyr::filter(group1==\"CON\"&group2==\"LR_DPVB\")\n\n\ne_left &lt;- ggbarplot(f2e, x = \"type\", y = \"pct\",\n                fill = \"trt\", palette = \"jco\",\n                add =c(\"mean_sd\"), add.params = list(group = \"trt\"),\n                position = position_dodge(1),\n                #legend=\"none\",\n          legend.title=\"\",\n          )+\n    scale_y_continuous(limits = c(0,80))+\n    stat_pvalue_manual(\n        data = stat.test,\n        label = \"p={p}({p.signif})\",\n        tip.length = 0.05,\n        y.position = c(40,75),\n        #bracket.nudge.y = -2,\n)+labs(\n        x='',\n        y='% in live CD45+ cell',\n        #title=\"Hepa1-6 tumor\"\n    )\n\ne_right &lt;- e_left\n\n(e_left + e_right)+\n    plot_annotation(\n        title = \"Hepa1-6 tumor\",\n    ) +\n    plot_layout(guides = \"collect\")& \n    theme(\n        plot.title = element_text(hjust = 0.5),\n        legend.position = \"top\",\n    )\n\n\n\n\n\n\n\n\nCodeggplot(mpg, aes(x = drv, y = hwy, fill = as.factor(cyl))) +  \n    geom_bar(stat = \"summary\",fun=mean, position = position_dodge(1)) +\n    stat_summary(fun.data = 'mean_sd',geom=\"errorbar\",position = position_dodge(1),\n                 width=.2,linewidth=1)+\n    geom_point(position = position_dodge(1), \n              size = 3,alpha=0.3\n             )  \n\n\n\n\n\n\n\n\n1.3.5 5 分组并列，组内组间显著性p值\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/\n\nCodelibrary(ggpubr)\nlibrary(rstatix)\ndf &lt;- ToothGrowth\ndf$dose &lt;- as.factor(df$dose)\n\n\n\nbp &lt;- ggbarplot(\n    df,\n    x = \"dose\",\n    y = \"len\",\n    add = \"mean_sd\",\n    color = \"supp\",\n    palette = c(\"#00AFBB\", \"#E7B800\"),\n    position = position_dodge(0.8)\n)\n\n\n# 统计检验\nstat.test &lt;- df %&gt;%\n    group_by(dose) %&gt;%\n    t_test(len ~ supp) %&gt;%\n    adjust_pvalue(method = \"bonferroni\") %&gt;%\n    add_significance(\"p.adj\")\nstat.test &lt;- stat.test %&gt;%\n    add_xy_position(fun = \"mean_sd\", x = \"dose\", dodge = 0.8)\n\n\nstat.test2 &lt;- df %&gt;%\n    t_test(len ~ dose, p.adjust.method = \"bonferroni\")\nstat.test2 &lt;- stat.test2 %&gt;%\n    add_xy_position(x = \"dose\")\n\npwc &lt;- df %&gt;%\n    group_by(supp) %&gt;%\n    t_test(len ~ dose, p.adjust.method = \"bonferroni\")\npwc\n#&gt; # A tibble: 6 × 11\n#&gt;   supp  .y.   group1 group2    n1    n2 statistic    df            p      p.adj\n#&gt; * &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;\n#&gt; 1 OJ    len   0.5    1         10    10     -5.05  17.7 0.0000878    0.000263  \n#&gt; 2 OJ    len   0.5    2         10    10     -7.82  14.7 0.00000132   0.00000396\n#&gt; 3 OJ    len   1      2         10    10     -2.25  15.8 0.039        0.118     \n#&gt; 4 VC    len   0.5    1         10    10     -7.46  17.9 0.000000681  0.00000204\n#&gt; 5 VC    len   0.5    2         10    10    -10.4   14.3 0.0000000468 0.00000014\n#&gt; 6 VC    len   1      2         10    10     -5.47  13.6 0.0000916    0.000275  \n#&gt; # ℹ 1 more variable: p.adj.signif &lt;chr&gt;\npwc &lt;- pwc %&gt;%\n    add_xy_position(\n        x = \"dose\",\n        fun = \"mean_sd\",\n        group = \"supp\",\n        dodge = 0.8\n    )\n\n# 组间组内复合\n\n\nbp +\n    stat_pvalue_manual(stat.test,  label = \"p.adj.signif\", tip.length = 0.01) +\n    stat_pvalue_manual(\n        stat.test2,\n        label = \"p\",\n        tip.length = 0.02,\n        step.increase = 0.05\n    ) +\n    scale_y_continuous(expand = expansion(mult = c(0.05, 0.1))) +\n    stat_pvalue_manual(\n        pwc,\n        color = \"supp\",\n        step.group.by = \"supp\",\n        tip.length = 0,\n        step.increase = 0.1\n    )",
    "crumbs": [
      "图",
      "01"
    ]
  },
  {
    "objectID": "01.html#折线图fig4-h",
    "href": "01.html#折线图fig4-h",
    "title": "",
    "section": "\n1.4 折线图：fig4 h",
    "text": "1.4 折线图：fig4 h\n\n1.4.1 1\n\nCodef4h &lt;-\n    read_excel(\"data/01source.xlsx\", sheet = \"Fig.4\", range = \"A20:P23\")\n#&gt; New names:\n#&gt; • `` -&gt; `...3`\n#&gt; • `` -&gt; `...4`\n#&gt; • `` -&gt; `...5`\n#&gt; • `` -&gt; `...6`\n#&gt; • `` -&gt; `...8`\n#&gt; • `` -&gt; `...9`\n#&gt; • `` -&gt; `...10`\n#&gt; • `` -&gt; `...11`\n#&gt; • `` -&gt; `...13`\n#&gt; • `` -&gt; `...14`\n#&gt; • `` -&gt; `...15`\n#&gt; • `` -&gt; `...16`\ncolnames(f4h) &lt;-\n    c(\"Days\", rep(\n        c(\"PBS\", \"SLAMF6+ PD-1+ CD8+ cells\", \"SLAMF6- PD-1+ CD8+ cells\"),\n        each = 5\n    ))\n\nf4h |&gt; pivot_longer(cols = -1,\n                    names_to = \"method\",\n                    values_to = \"volume\",\n) |&gt;\n    dplyr::mutate(Days = factor(Days, levels = c(\"-1\", \"7\", \"14\")),\n                  method = factor(\n                      method,\n                      levels = c(\"PBS\", \"SLAMF6+ PD-1+ CD8+ cells\",\n                                 \"SLAMF6- PD-1+ CD8+ cells\")\n                  )) -&gt; f4h\nf4h &lt;- rowid_to_column(f4h,var = \"id\")\n\n\n统计p值\n\nCode# 重复测量方差设计\nlibrary(nlme)\nmodel &lt;- lme(volume ~ method*Days, random = ~1|id/Days, data = f4h)\nsummary(model)\n#&gt; Linear mixed-effects model fit by REML\n#&gt;   Data: f4h \n#&gt;        AIC      BIC    logLik\n#&gt;   305.8048 324.8071 -140.9024\n#&gt; \n#&gt; Random effects:\n#&gt;  Formula: ~1 | id\n#&gt;         (Intercept)\n#&gt; StdDev:    6.775335\n#&gt; \n#&gt;  Formula: ~1 | Days %in% id\n#&gt;         (Intercept) Residual\n#&gt; StdDev:    6.775335 2.540755\n#&gt; \n#&gt; Fixed effects:  volume ~ method * Days \n#&gt;                                           Value Std.Error DF   t-value p-value\n#&gt; (Intercept)                            25.43718  4.433188 36  5.737899  0.0000\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells         10.81993  6.269474 36  1.725812  0.0930\n#&gt; methodSLAMF6- PD-1+ CD8+ cells          4.63341  6.269474 36  0.739043  0.4647\n#&gt; Days7                                   9.55505  6.269474 36  1.524059  0.1362\n#&gt; Days14                                 22.41864  6.269474 36  3.575841  0.0010\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7  -37.58056  8.866375 36 -4.238549  0.0001\n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7   -8.90525  8.866375 36 -1.004384  0.3219\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14 -55.79891  8.866375 36 -6.293316  0.0000\n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14 -14.68420  8.866375 36 -1.656167  0.1064\n#&gt;  Correlation: \n#&gt;                                       (Intr) mtSLAMF6+PD-1+CD8+c\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells        -0.707                    \n#&gt; methodSLAMF6- PD-1+ CD8+ cells        -0.707  0.500             \n#&gt; Days7                                 -0.707  0.500             \n#&gt; Days14                                -0.707  0.500             \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7   0.500 -0.707             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7   0.500 -0.354             \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14  0.500 -0.707             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14  0.500 -0.354             \n#&gt;                                       mtSLAMF6-PD-1+CD8+c Days7  Days14\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells                                         \n#&gt; methodSLAMF6- PD-1+ CD8+ cells                                         \n#&gt; Days7                                  0.500                           \n#&gt; Days14                                 0.500               0.500       \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7  -0.354              -0.707 -0.354\n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7  -0.707              -0.707 -0.354\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14 -0.354              -0.354 -0.707\n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14 -0.707              -0.354 -0.707\n#&gt;                                       mSLAMF6+PD-1+CD8+c:D7\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells                             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells                             \n#&gt; Days7                                                      \n#&gt; Days14                                                     \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7   0.500               \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14  0.500               \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14  0.250               \n#&gt;                                       mSLAMF6-PD-1+CD8+c:D7\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells                             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells                             \n#&gt; Days7                                                      \n#&gt; Days14                                                     \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14  0.250               \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14  0.500               \n#&gt;                                       mSLAMF6+PD-1+CD8+c:D1\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells                             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells                             \n#&gt; Days7                                                      \n#&gt; Days14                                                     \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14                      \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14  0.500               \n#&gt; \n#&gt; Standardized Within-Group Residuals:\n#&gt;         Min          Q1         Med          Q3         Max \n#&gt; -0.54102103 -0.09310952 -0.02293325  0.11100673  0.62463379 \n#&gt; \n#&gt; Number of Observations: 45\n#&gt; Number of Groups: \n#&gt;           id Days %in% id \n#&gt;           45           45\ndf_aov &lt;- anova(model)\ndf_aov\n#&gt;             numDF denDF  F-value p-value\n#&gt; (Intercept)     1    36 365.4570  &lt;.0001\n#&gt; method          2    36  18.1753  &lt;.0001\n#&gt; Days            2    36   1.5292  0.2305\n#&gt; method:Days     4    36  11.1001  &lt;.0001\n\n#成对比较\nlibrary(emmeans)\nmethod_means &lt;- emmeans(model, ~method)  \n#&gt; NOTE: Results may be misleading due to involvement in interactions\nprint(method_means)  \n#&gt;  method                   emmean   SE df lower.CL upper.CL\n#&gt;  PBS                        36.1 2.56 36     30.9     41.3\n#&gt;  SLAMF6+ PD-1+ CD8+ cells   15.8 2.56 36     10.6     21.0\n#&gt;  SLAMF6- PD-1+ CD8+ cells   32.9 2.56 36     27.7     38.1\n#&gt; \n#&gt; Results are averaged over the levels of: Days \n#&gt; Degrees-of-freedom method: containment \n#&gt; Confidence level used: 0.95\nmethod_comparisons &lt;- pairs(method_means)  \nmethod_comparisons\n#&gt;  contrast                                                estimate   SE df\n#&gt;  PBS - (SLAMF6+ PD-1+ CD8+ cells)                           20.31 3.62 36\n#&gt;  PBS - (SLAMF6- PD-1+ CD8+ cells)                            3.23 3.62 36\n#&gt;  (SLAMF6+ PD-1+ CD8+ cells) - (SLAMF6- PD-1+ CD8+ cells)   -17.08 3.62 36\n#&gt;  t.ratio p.value\n#&gt;    5.610  &lt;.0001\n#&gt;    0.892  0.6486\n#&gt;   -4.718  0.0001\n#&gt; \n#&gt; Results are averaged over the levels of: Days \n#&gt; Degrees-of-freedom method: containment \n#&gt; P value adjustment: tukey method for comparing a family of 3 estimates\n\n\n\nCodepvalue &lt;- method_comparisons |&gt; broom::tidy() |&gt; \n    dplyr::select(contrast, adj.p.value) |&gt; \n    dplyr::mutate(padj=round(adj.p.value,digits = 4),\n                  p_adj_sci=format(adj.p.value,scientific = T,digits = 4))\n\npvalue\n#&gt; # A tibble: 3 × 4\n#&gt;   contrast                                          adj.p.value   padj p_adj_sci\n#&gt;   &lt;chr&gt;                                                   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    \n#&gt; 1 PBS - (SLAMF6+ PD-1+ CD8+ cells)                   0.00000680 0      6.796e-06\n#&gt; 2 PBS - (SLAMF6- PD-1+ CD8+ cells)                   0.649      0.649  6.486e-01\n#&gt; 3 (SLAMF6+ PD-1+ CD8+ cells) - (SLAMF6- PD-1+ CD8+…  0.000103   0.0001 1.032e-04\n\nlibrary(ggpubr)\np &lt;- f4h |&gt; summarise(\n    mean_volume = mean(volume),\n    sd = sd(volume),\n    .by = c(Days, method),) |&gt;\n    ggplot(aes(\n        x = Days,\n        y = mean_volume,\n        color = method,\n        group = method,)) +\n    geom_errorbar(\n        aes(ymin = mean_volume - sd, ymax = mean_volume + sd),\n        position = position_dodge(0),\n        width = .2,\n        linewidth = 0.5,\n    ) +\n    geom_line(position = position_dodge(0),\n              linewidth = 0.8) +\n    geom_point(\n        aes(shape = method),\n        position = position_dodge(0),\n        color = \"black\",\n        size = 2) +\n    theme_pubr() +\n    theme(legend.title = element_blank())\n\n# 使用ggplot_build()获取图层数据\nplot_data &lt;- ggplot_build(p)\n\n# 查看X轴的数值坐标\nplot_data$data\n#&gt; [[1]]\n#&gt;    colour       ymin      ymax x         y group PANEL flipped_aes      xmin\n#&gt; 1 #F8766D 21.2341315 29.640231 1 25.437181     1     1       FALSE 0.9666667\n#&gt; 2 #00BA38 29.8251093 42.689121 1 36.257115     2     1       FALSE 0.9666667\n#&gt; 3 #619CFF 23.2386460 36.902540 1 30.070593     3     1       FALSE 0.9666667\n#&gt; 4 #F8766D 20.3358912 49.648564 2 34.992228     1     1       FALSE 1.9666667\n#&gt; 5 #00BA38  4.8856152 11.577581 2  8.231598     2     1       FALSE 1.9666667\n#&gt; 6 #619CFF 22.3836755 39.057109 2 30.720392     3     1       FALSE 1.9666667\n#&gt; 7 #F8766D 28.7160676 66.995581 3 47.855824     1     1       FALSE 2.9666667\n#&gt; 8 #00BA38  0.5880804  5.165626 3  2.876853     2     1       FALSE 2.9666667\n#&gt; 9 #619CFF 27.2406302 48.369439 3 37.805035     3     1       FALSE 2.9666667\n#&gt;       xmax linewidth linetype width alpha\n#&gt; 1 1.033333       0.5        1   0.2    NA\n#&gt; 2 1.033333       0.5        1   0.2    NA\n#&gt; 3 1.033333       0.5        1   0.2    NA\n#&gt; 4 2.033333       0.5        1   0.2    NA\n#&gt; 5 2.033333       0.5        1   0.2    NA\n#&gt; 6 2.033333       0.5        1   0.2    NA\n#&gt; 7 3.033333       0.5        1   0.2    NA\n#&gt; 8 3.033333       0.5        1   0.2    NA\n#&gt; 9 3.033333       0.5        1   0.2    NA\n#&gt; \n#&gt; [[2]]\n#&gt;    colour x         y group PANEL flipped_aes xmin xmax      ymax linewidth\n#&gt; 1 #F8766D 1 25.437181     1     1       FALSE    1    1 25.437181       0.8\n#&gt; 2 #F8766D 2 34.992228     1     1       FALSE    2    2 34.992228       0.8\n#&gt; 3 #F8766D 3 47.855824     1     1       FALSE    3    3 47.855824       0.8\n#&gt; 4 #00BA38 1 36.257115     2     1       FALSE    1    1 36.257115       0.8\n#&gt; 5 #00BA38 2  8.231598     2     1       FALSE    2    2  8.231598       0.8\n#&gt; 6 #00BA38 3  2.876853     2     1       FALSE    3    3  2.876853       0.8\n#&gt; 7 #619CFF 1 30.070593     3     1       FALSE    1    1 30.070593       0.8\n#&gt; 8 #619CFF 2 30.720392     3     1       FALSE    2    2 30.720392       0.8\n#&gt; 9 #619CFF 3 37.805035     3     1       FALSE    3    3 37.805035       0.8\n#&gt;   linetype alpha\n#&gt; 1        1    NA\n#&gt; 2        1    NA\n#&gt; 3        1    NA\n#&gt; 4        1    NA\n#&gt; 5        1    NA\n#&gt; 6        1    NA\n#&gt; 7        1    NA\n#&gt; 8        1    NA\n#&gt; 9        1    NA\n#&gt; \n#&gt; [[3]]\n#&gt;   shape x         y group PANEL xmin xmax      ymax colour size fill alpha\n#&gt; 1    16 1 25.437181     1     1    1    1 25.437181  black    2   NA    NA\n#&gt; 2    17 1 36.257115     2     1    1    1 36.257115  black    2   NA    NA\n#&gt; 3    15 1 30.070593     3     1    1    1 30.070593  black    2   NA    NA\n#&gt; 4    16 2 34.992228     1     1    2    2 34.992228  black    2   NA    NA\n#&gt; 5    17 2  8.231598     2     1    2    2  8.231598  black    2   NA    NA\n#&gt; 6    15 2 30.720392     3     1    2    2 30.720392  black    2   NA    NA\n#&gt; 7    16 3 47.855824     1     1    3    3 47.855824  black    2   NA    NA\n#&gt; 8    17 3  2.876853     2     1    3    3  2.876853  black    2   NA    NA\n#&gt; 9    15 3 37.805035     3     1    3    3 37.805035  black    2   NA    NA\n#&gt;   stroke\n#&gt; 1    0.5\n#&gt; 2    0.5\n#&gt; 3    0.5\n#&gt; 4    0.5\n#&gt; 5    0.5\n#&gt; 6    0.5\n#&gt; 7    0.5\n#&gt; 8    0.5\n#&gt; 9    0.5\n\n\n\np  +  annotate(geom = \"segment\",\n               x = 3.4,\n               y = 47.855824,\n               yend = 2.876853,) + annotate(\n                   geom = \"text\",\n                   x = 3.45,\n                   y = (47.855824 + 2.876853) / 2,\n                   angle = 270,\n                   label = pvalue$padj[2],\n               ) +\n    annotate(geom = \"segment\",\n             x = 3.15,\n             y = 47.855824,\n             yend = 37.805035,) + annotate(\n                 geom = \"text\",\n                 x = 3.2,\n                 y = (47.855824 + 37.805035) / 2,\n                 angle = 270,\n                 label = pvalue$padj[1],\n             ) +\n    annotate(geom = \"segment\",\n             x = 3.3,\n             y = 2.876853,\n             yend = 37.805035,) + annotate(\n                 geom = \"text\",\n                 x = 3.35,\n                 y = (2.876853 + 37.805035) / 2,\n                 angle = 270,\n                 label = pvalue$padj[3],\n             )\n\n\n\n\n\n\nCode\n#y=c(47.855824,37.805035,2.876853,),\n#yend = c(2.876853,47.855824,37.805035,),\n\n\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/\n\n1.4.2 2\n\nCodelp &lt;- ggline(\n    df,\n    x = \"dose\",\n    y = \"len\",\n    add = \"mean_sd\",\n    color = \"supp\",\n    palette = c(\"#00AFBB\", \"#E7B800\")\n)\nlp\n\n\n\n\n\n\nCode# Add p-values onto the line plots\n# Remove brackets using linetype = \"blank\"\nstat.test &lt;- stat.test %&gt;%\n    add_xy_position(fun = \"mean_sd\", x = \"dose\")\nlp + stat_pvalue_manual(stat.test,\n                        label = \"p.adj.signif\",\n                        tip.length = 0,\n                        linetype  = \"blank\")",
    "crumbs": [
      "图",
      "01"
    ]
  },
  {
    "objectID": "01.html#拟合曲线r2-p值f6c",
    "href": "01.html#拟合曲线r2-p值f6c",
    "title": "",
    "section": "\n1.5 拟合曲线R2 ,p值：f6c",
    "text": "1.5 拟合曲线R2 ,p值：f6c\n\nCode# 示例数据\ndf &lt;- data.frame(\n  x = 1:100,\n  y = rnorm(100) + 2 * (1:100)  # 生成具有线性关系的x和y数据\n)\n\n# 创建基本的ggplot对象\np &lt;- ggplot(df, aes(x = x, y = y))+\n    geom_point(color='red')+\n    geom_smooth(method = \"lm\",formula = \"y~x\",color=\"black\",linewidth=.8)\n\n# 使用stat_poly_eq()添加线性回归方程、R²和p值\np + ggpmisc::stat_poly_eq(formula = y ~ x,\n                 ggpmisc::use_label(c(\"eq\", \"adj.R2\", \"P\")))\n#&gt; Registered S3 methods overwritten by 'ggpp':\n#&gt;   method                  from   \n#&gt;   heightDetails.titleGrob ggplot2\n#&gt;   widthDetails.titleGrob  ggplot2\n#&gt; Registered S3 method overwritten by 'ggpmisc':\n#&gt;   method                  from   \n#&gt;   as.character.polynomial polynom",
    "crumbs": [
      "图",
      "01"
    ]
  },
  {
    "objectID": "01.html#点图",
    "href": "01.html#点图",
    "title": "",
    "section": "\n1.6 点图",
    "text": "1.6 点图\n\nCodef6d &lt;-\n    read_excel(\"data/01source.xlsx\", sheet = \"Fig.6\", range = \"D2:E18\")\nf6d |&gt; pivot_longer(\n    cols = everything(),\n    names_to = \"status\",\n    values_to = \"Ratio\",\n    ) |&gt; \n    tidyr::drop_na() -&gt;f6d\n\nggdotplot(f6d,\n          x=\"status\",\n          y=\"Ratio\",\n          add =c(\"mean_sd\"),\n          color = \"status\",\n          fill = \"status\",\n          error.plot = \"errorbar\",\n          )+\n    geom_signif(\n        comparisons = list(c(\"relapse\",\"non-relapse\")),\n    )+\n    ggplot2::annotate(\n        geom=\"segment\",\n        x=0.9,\n        xend=1.1,\n        y=2.42019873,#均值\n    )+\n    ggplot2::annotate(\n        geom=\"segment\",\n        x=1.9,\n        xend=2.1,\n        y=0.789463173,#均值\n    )\n#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with\n#&gt; `binwidth`.",
    "crumbs": [
      "图",
      "01"
    ]
  },
  {
    "objectID": "01.html#曼哈顿图",
    "href": "01.html#曼哈顿图",
    "title": "",
    "section": "\n1.7 曼哈顿图",
    "text": "1.7 曼哈顿图\n在医学科研中，曼哈顿图主要用来展示全基因组关联研究（GWAS）的数据。在R语言中，曼哈顿图可由qqman包绘制",
    "crumbs": [
      "图",
      "01"
    ]
  },
  {
    "objectID": "01.html#ggcorrplot",
    "href": "01.html#ggcorrplot",
    "title": "",
    "section": "\n1.8 ggcorrplot",
    "text": "1.8 ggcorrplot\n\nCodelibrary(ggcorrplot)\ndata(\"iris\")\ncor&lt;-cor(iris[,1:4])\nggcorrplot(cor)\n\n\n\n\n\n\nCodep.mat &lt;- ggcorrplot::cor_pmat(cor)\nggcorrplot(cor,hc.order=TRUE,lab=TRUE)\n\n\n\n\n\n\nCode\nggcorrplot(cor, hc.order = TRUE, p.mat = p.mat) + \n    labs(title = \"鸢尾花数据集指标相关性\") +\n    theme(plot.title = element_text(hjust = 0.5))",
    "crumbs": [
      "图",
      "01"
    ]
  },
  {
    "objectID": "01.html#韦恩图",
    "href": "01.html#韦恩图",
    "title": "",
    "section": "\n1.9 韦恩图",
    "text": "1.9 韦恩图\n　　一般来说, 超过 5 个集合后就不再适合使用韦恩图, 此时集合间重叠的信息难以辨认",
    "crumbs": [
      "图",
      "01"
    ]
  },
  {
    "objectID": "Table.html",
    "href": "Table.html",
    "title": "",
    "section": "",
    "text": "Code\n\n\n\n\n\n表格\n三线表\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "表",
      "表格"
    ]
  },
  {
    "objectID": "barplot.html",
    "href": "barplot.html",
    "title": "",
    "section": "",
    "text": "条图条图 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "图",
      "条图",
      "条图"
    ]
  },
  {
    "objectID": "barplot.html#基础柱状图",
    "href": "barplot.html#基础柱状图",
    "title": "",
    "section": "\n1.1 基础柱状图",
    "text": "1.1 基础柱状图\n\nCodeggplot(df,aes(supp,len))+\n    geom_col()\n\n\n\n\n\n\nCode\nggplot(df,aes(supp,len))+\n    geom_bar(stat = \"identity\")",
    "crumbs": [
      "图",
      "条图",
      "条图"
    ]
  },
  {
    "objectID": "barplot.html#颜色",
    "href": "barplot.html#颜色",
    "title": "",
    "section": "\n1.2 颜色",
    "text": "1.2 颜色\n\nCodeggplot(df,aes(id,len,color=factor(dose)))+\n    geom_col(fill=NA)",
    "crumbs": [
      "图",
      "条图",
      "条图"
    ]
  },
  {
    "objectID": "barplot.html#标签",
    "href": "barplot.html#标签",
    "title": "",
    "section": "\n1.3 标签",
    "text": "1.3 标签\n\nCodeggplot(df,aes(id,len))+\n    geom_col()+\n   ggrepel::geom_text_repel(aes(y=len+3,label=len))",
    "crumbs": [
      "图",
      "条图",
      "条图"
    ]
  },
  {
    "objectID": "barplot.html#散点抖动点",
    "href": "barplot.html#散点抖动点",
    "title": "",
    "section": "\n1.4 散点、抖动点",
    "text": "1.4 散点、抖动点\n\nCode\nggplot(df, aes(x = supp, y = len)) +\n    geom_bar(\n        aes(fill = factor(dose)),\n        stat = \"summary\",\n        fun = mean,\n        position = position_dodge(width = 0.9)\n    ) +\n    geom_point(position = position_jitterdodge(jitter.width = 0.1),\n               aes(color = factor(dose)),\n               alpha = 0.7)+\n    scale_color_manual(values = c(\"red\",\"green\",\"blue\"))|\n    ggplot(df, aes(x = supp, y = len)) +\n    geom_bar(\n        aes(fill = factor(dose)),\n        stat = \"summary\",\n        fun = mean,\n        position = position_dodge(width = 0.9)\n    ) +\n    geom_dotplot(position = position_dodge(width = 0.9),\n               aes(fill = factor(dose)),dotsize = 0.8,\n               binaxis = \"y\", stackdir = \"center\",color=\"black\",\n               alpha = 0.7)+\n    scale_fill_manual(values = c(\"red\",\"green\",\"blue\"))\n#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with\n#&gt; `binwidth`.",
    "crumbs": [
      "图",
      "条图",
      "条图"
    ]
  }
]