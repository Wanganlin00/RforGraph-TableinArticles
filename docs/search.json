[
  {
    "objectID": "相关图.html",
    "href": "相关图.html",
    "title": "",
    "section": "",
    "text": "关系图相关图 CodeShow All CodeHide All CodeView Source\n1 相关图\n\nCodelibrary(tidyverse)\nlibrary(ggcorrplot)\n\n\n\nCodedata(\"iris\")\ncor&lt;-cor(iris[,1:4])\nggcorrplot(cor)\n\n\n\n\n\n\nCodep.mat &lt;- ggcorrplot::cor_pmat(cor)\nggcorrplot(cor,hc.order=TRUE,lab=TRUE)\n\n\n\n\n\n\nCode\nggcorrplot(cor, hc.order = TRUE, p.mat = p.mat) + \n    labs(title = \"鸢尾花数据集指标相关性\") +\n    theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\n\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "图",
      "关系图",
      "相关图"
    ]
  },
  {
    "objectID": "热图.html",
    "href": "热图.html",
    "title": "",
    "section": "",
    "text": "关系图热图 CodeShow All CodeHide All CodeView Source\n1 热图\n\nCodelibrary(pheatmap)\n# Create test matrix\ntest = matrix(rnorm(200), 20, 10)\ntest[1:10, seq(1, 10, 2)] = test[1:10, seq(1, 10, 2)] + 3\ntest[11:20, seq(2, 10, 2)] = test[11:20, seq(2, 10, 2)] + 2\ntest[15:20, seq(2, 10, 2)] = test[15:20, seq(2, 10, 2)] + 4\ncolnames(test) = paste(\"Test\", 1:10, sep = \"\")\nrownames(test) = paste(\"Gene\", 1:20, sep = \"\")\n\n\n\nCodetest\n#&gt;             Test1      Test2       Test3       Test4      Test5       Test6\n#&gt; Gene1   2.9221322 -1.7243731  3.67620907  1.34378990  3.6337590 -1.42957649\n#&gt; Gene2   3.1591798 -0.1541560  2.05722754  1.73984222  2.3987775 -0.47639635\n#&gt; Gene3   2.9015716 -1.0323585  3.18465375 -0.88217251  3.8684726  0.38323993\n#&gt; Gene4   2.1281628 -0.6762187  4.61950157  0.08765037  3.1149158 -0.30003349\n#&gt; Gene5   4.1061829  0.2916416  3.27637421  0.16934959  2.0008872  0.86110877\n#&gt; Gene6   3.5248551  0.4056824  3.59040967  1.90051201  2.1070789 -1.88019204\n#&gt; Gene7   2.2337619 -0.3036556  4.05306774  0.21363579  3.3890528  0.77671901\n#&gt; Gene8   3.2784185 -0.5765126  3.26859643  1.12379179  4.0192545 -1.13654307\n#&gt; Gene9   4.5849323 -0.7081757  4.75123415 -0.45752242  4.2275205  1.33943498\n#&gt; Gene10  0.3233323  0.8483846  5.38819218  0.63819358  2.6323448  0.04405156\n#&gt; Gene11  1.3031414  2.6565248  0.89550835  2.49563548  0.6072895  3.19922656\n#&gt; Gene12 -1.3008889  4.0634046  1.34214374  4.80106946 -0.3323364  1.01984803\n#&gt; Gene13  0.6624692  1.8855421  0.51979444  3.25928384  0.2876754  1.96987211\n#&gt; Gene14  1.1403375  0.9904905 -0.11634211  3.96960605  1.7222033  1.08026588\n#&gt; Gene15 -1.6489584  7.1388132  0.02328804  4.76596225 -0.3884397  5.70549618\n#&gt; Gene16 -1.8691886  6.5417834 -0.70395392  6.00287226  0.3310780  4.42480193\n#&gt; Gene17 -1.8396103  6.8569167 -1.73890807  6.96588367 -0.9031065  4.96568043\n#&gt; Gene18 -0.6071349  4.8251852 -0.68392577  6.30947927  0.1663996  6.11504682\n#&gt; Gene19  1.7406506  5.2042010 -0.42301787  6.67013537  0.2852060  6.18111961\n#&gt; Gene20 -0.3458765  5.3248995  1.33857782  4.27578817  0.5626585  7.19402516\n#&gt;              Test7       Test8      Test9      Test10\n#&gt; Gene1   1.71503343 -0.03920524  1.6228211  0.09777607\n#&gt; Gene2   1.02457589  0.46092696  5.7489573 -1.68562799\n#&gt; Gene3   2.60888094  0.31436712  5.2519592 -1.05150422\n#&gt; Gene4   2.89159245  1.08424240  2.9550842 -1.36787611\n#&gt; Gene5   3.18191774 -0.12723768  4.8512963 -0.84790824\n#&gt; Gene6   2.01216001 -0.58069859  1.5337718 -0.16620108\n#&gt; Gene7   4.39309815  0.02625833  3.1702939  1.61402503\n#&gt; Gene8   4.04833650  1.88608076  2.1184821 -0.91016346\n#&gt; Gene9   0.51917988  0.98554794  1.5724171 -1.52591432\n#&gt; Gene10  3.42841001 -0.11107565  2.8931628 -0.34053157\n#&gt; Gene11 -0.49601467  2.39832947 -1.3459775  3.08038478\n#&gt; Gene12 -0.26741971  1.88212347 -0.5124285  2.55729851\n#&gt; Gene13  0.46353569  2.51682827  1.2089161  3.31412660\n#&gt; Gene14 -0.11435872  2.68252754 -0.6709232  0.82269006\n#&gt; Gene15  1.03011672  6.03911138 -0.1994253  7.80536766\n#&gt; Gene16 -0.06545574  5.04199863  1.0176420  6.88069088\n#&gt; Gene17  1.13340250  6.84714030 -0.4684841  6.09390105\n#&gt; Gene18  0.09716818  6.09108337  0.6817683  5.16966269\n#&gt; Gene19  0.48622365  7.38444318  0.4014297  7.31789136\n#&gt; Gene20 -1.78003751  6.01938086  0.3818191  6.28697033\n\n\n\nCodeannotation_col = data.frame(type=c(rep(\"normal\",5),rep(\"tumor\",5)))\nrownames(annotation_col) &lt;- colnames(test)\nanno_colors &lt;- list(type=c(normal=\"#1b9e77\",tumor=\"#d95f02\"))\n\npheatmap(test,show_rownames = T,show_colnames = F,cluster_rows = F,treeheight_col = 5,display_numbers = T,\n         gaps_col = 5,annotation_col = annotation_col,annotation_colors = anno_colors,annotation_legend = \n             F)\n\n\n\n\n\n\n\n均一化z-score\n\nCodepheatmap(test,scale = \"column\",border_color = \"green\",fontsize = 8)\n\n\n\n\n\n\n\n\nCodepheatmap(test,scale = \"row\",border_color = NA,color = colorRampPalette(c(\"blue\",\"white\",\"red\"))(200))\n\n\n\n\n\n\n\n\nCodelibrary(ComplexHeatmap)\n#&gt; Loading required package: grid\n#&gt; ========================================\n#&gt; ComplexHeatmap version 2.20.0\n#&gt; Bioconductor page: http://bioconductor.org/packages/ComplexHeatmap/\n#&gt; Github page: https://github.com/jokergoo/ComplexHeatmap\n#&gt; Documentation: http://jokergoo.github.io/ComplexHeatmap-reference\n#&gt; \n#&gt; If you use it in published research, please cite either one:\n#&gt; - Gu, Z. Complex Heatmap Visualization. iMeta 2022.\n#&gt; - Gu, Z. Complex heatmaps reveal patterns and correlations in multidimensional \n#&gt;     genomic data. Bioinformatics 2016.\n#&gt; \n#&gt; \n#&gt; The new InteractiveComplexHeatmap package can directly export static \n#&gt; complex heatmaps into an interactive Shiny app with zero effort. Have a try!\n#&gt; \n#&gt; This message can be suppressed by:\n#&gt;   suppressPackageStartupMessages(library(ComplexHeatmap))\n#&gt; ========================================\n#&gt; ! pheatmap() has been masked by ComplexHeatmap::pheatmap(). Most of the arguments\n#&gt;    in the original pheatmap() are identically supported in the new function. You \n#&gt;    can still use the original function by explicitly calling pheatmap::pheatmap().\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "图",
      "关系图",
      "热图"
    ]
  },
  {
    "objectID": "折线图.html",
    "href": "折线图.html",
    "title": "",
    "section": "",
    "text": "线图折线图 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "图",
      "线图",
      "折线图"
    ]
  },
  {
    "objectID": "折线图.html#折线图",
    "href": "折线图.html#折线图",
    "title": "",
    "section": "\n1 折线图",
    "text": "1 折线图\n\nCodelibrary(tidyverse)\nlibrary(readxl)\nlibrary(ggpubr)\nlibrary(rstatix)\n\n\n\nCodef4h &lt;-\n    read_excel(\"data/01source.xlsx\", sheet = \"Fig.4\", range = \"A20:P23\")\n#&gt; New names:\n#&gt; • `` -&gt; `...3`\n#&gt; • `` -&gt; `...4`\n#&gt; • `` -&gt; `...5`\n#&gt; • `` -&gt; `...6`\n#&gt; • `` -&gt; `...8`\n#&gt; • `` -&gt; `...9`\n#&gt; • `` -&gt; `...10`\n#&gt; • `` -&gt; `...11`\n#&gt; • `` -&gt; `...13`\n#&gt; • `` -&gt; `...14`\n#&gt; • `` -&gt; `...15`\n#&gt; • `` -&gt; `...16`\ncolnames(f4h) &lt;-\n    c(\"Days\", rep(\n        c(\"PBS\", \"SLAMF6+ PD-1+ CD8+ cells\", \"SLAMF6- PD-1+ CD8+ cells\"),\n        each = 5\n    ))\n\nf4h |&gt; pivot_longer(cols = -1,\n                    names_to = \"method\",\n                    values_to = \"volume\",\n) |&gt;\n    dplyr::mutate(Days = factor(Days, levels = c(\"-1\", \"7\", \"14\")),\n                  method = factor(\n                      method,\n                      levels = c(\"PBS\", \"SLAMF6+ PD-1+ CD8+ cells\",\n                                 \"SLAMF6- PD-1+ CD8+ cells\")\n                  )) -&gt; f4h\nf4h &lt;- rowid_to_column(f4h,var = \"id\")\n\n\n统计p值\n\nCode# 重复测量方差设计\nlibrary(nlme)\nmodel &lt;- lme(volume ~ method*Days, random = ~1|id/Days, data = f4h)\nsummary(model)\n#&gt; Linear mixed-effects model fit by REML\n#&gt;   Data: f4h \n#&gt;        AIC      BIC    logLik\n#&gt;   305.8048 324.8071 -140.9024\n#&gt; \n#&gt; Random effects:\n#&gt;  Formula: ~1 | id\n#&gt;         (Intercept)\n#&gt; StdDev:    6.775335\n#&gt; \n#&gt;  Formula: ~1 | Days %in% id\n#&gt;         (Intercept) Residual\n#&gt; StdDev:    6.775335 2.540755\n#&gt; \n#&gt; Fixed effects:  volume ~ method * Days \n#&gt;                                           Value Std.Error DF   t-value p-value\n#&gt; (Intercept)                            25.43718  4.433188 36  5.737899  0.0000\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells         10.81993  6.269474 36  1.725812  0.0930\n#&gt; methodSLAMF6- PD-1+ CD8+ cells          4.63341  6.269474 36  0.739043  0.4647\n#&gt; Days7                                   9.55505  6.269474 36  1.524059  0.1362\n#&gt; Days14                                 22.41864  6.269474 36  3.575841  0.0010\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7  -37.58056  8.866375 36 -4.238549  0.0001\n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7   -8.90525  8.866375 36 -1.004384  0.3219\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14 -55.79891  8.866375 36 -6.293316  0.0000\n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14 -14.68420  8.866375 36 -1.656167  0.1064\n#&gt;  Correlation: \n#&gt;                                       (Intr) mtSLAMF6+PD-1+CD8+c\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells        -0.707                    \n#&gt; methodSLAMF6- PD-1+ CD8+ cells        -0.707  0.500             \n#&gt; Days7                                 -0.707  0.500             \n#&gt; Days14                                -0.707  0.500             \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7   0.500 -0.707             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7   0.500 -0.354             \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14  0.500 -0.707             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14  0.500 -0.354             \n#&gt;                                       mtSLAMF6-PD-1+CD8+c Days7  Days14\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells                                         \n#&gt; methodSLAMF6- PD-1+ CD8+ cells                                         \n#&gt; Days7                                  0.500                           \n#&gt; Days14                                 0.500               0.500       \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7  -0.354              -0.707 -0.354\n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7  -0.707              -0.707 -0.354\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14 -0.354              -0.354 -0.707\n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14 -0.707              -0.354 -0.707\n#&gt;                                       mSLAMF6+PD-1+CD8+c:D7\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells                             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells                             \n#&gt; Days7                                                      \n#&gt; Days14                                                     \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7   0.500               \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14  0.500               \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14  0.250               \n#&gt;                                       mSLAMF6-PD-1+CD8+c:D7\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells                             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells                             \n#&gt; Days7                                                      \n#&gt; Days14                                                     \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14  0.250               \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14  0.500               \n#&gt;                                       mSLAMF6+PD-1+CD8+c:D1\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells                             \n#&gt; methodSLAMF6- PD-1+ CD8+ cells                             \n#&gt; Days7                                                      \n#&gt; Days14                                                     \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days7                       \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells:Days14                      \n#&gt; methodSLAMF6- PD-1+ CD8+ cells:Days14  0.500               \n#&gt; \n#&gt; Standardized Within-Group Residuals:\n#&gt;         Min          Q1         Med          Q3         Max \n#&gt; -0.54102103 -0.09310952 -0.02293325  0.11100673  0.62463379 \n#&gt; \n#&gt; Number of Observations: 45\n#&gt; Number of Groups: \n#&gt;           id Days %in% id \n#&gt;           45           45\ndf_aov &lt;- anova(model)\ndf_aov\n#&gt;             numDF denDF  F-value p-value\n#&gt; (Intercept)     1    36 365.4570  &lt;.0001\n#&gt; method          2    36  18.1753  &lt;.0001\n#&gt; Days            2    36   1.5292  0.2305\n#&gt; method:Days     4    36  11.1001  &lt;.0001\n\n#成对比较\nlibrary(emmeans)\n#&gt; Welcome to emmeans.\n#&gt; Caution: You lose important information if you filter this package's results.\n#&gt; See '? untidy'\nmethod_means &lt;- emmeans(model, ~method)  \n#&gt; NOTE: Results may be misleading due to involvement in interactions\nprint(method_means)  \n#&gt;  method                   emmean   SE df lower.CL upper.CL\n#&gt;  PBS                        36.1 2.56 36     30.9     41.3\n#&gt;  SLAMF6+ PD-1+ CD8+ cells   15.8 2.56 36     10.6     21.0\n#&gt;  SLAMF6- PD-1+ CD8+ cells   32.9 2.56 36     27.7     38.1\n#&gt; \n#&gt; Results are averaged over the levels of: Days \n#&gt; Degrees-of-freedom method: containment \n#&gt; Confidence level used: 0.95\nmethod_comparisons &lt;- pairs(method_means)  \nmethod_comparisons\n#&gt;  contrast                                                estimate   SE df\n#&gt;  PBS - (SLAMF6+ PD-1+ CD8+ cells)                           20.31 3.62 36\n#&gt;  PBS - (SLAMF6- PD-1+ CD8+ cells)                            3.23 3.62 36\n#&gt;  (SLAMF6+ PD-1+ CD8+ cells) - (SLAMF6- PD-1+ CD8+ cells)   -17.08 3.62 36\n#&gt;  t.ratio p.value\n#&gt;    5.610  &lt;.0001\n#&gt;    0.892  0.6486\n#&gt;   -4.718  0.0001\n#&gt; \n#&gt; Results are averaged over the levels of: Days \n#&gt; Degrees-of-freedom method: containment \n#&gt; P value adjustment: tukey method for comparing a family of 3 estimates",
    "crumbs": [
      "图",
      "线图",
      "折线图"
    ]
  },
  {
    "objectID": "折线图.html#ggplot2",
    "href": "折线图.html#ggplot2",
    "title": "",
    "section": "\n2 ggplot2",
    "text": "2 ggplot2\n\nCodepvalue &lt;- method_comparisons |&gt; broom::tidy() |&gt; \n    dplyr::select(contrast, adj.p.value) |&gt; \n    dplyr::mutate(padj=round(adj.p.value,digits = 4),\n                  p_adj_sci=format(adj.p.value,scientific = T,digits = 4))\n\npvalue\n#&gt; # A tibble: 3 × 4\n#&gt;   contrast                                          adj.p.value   padj p_adj_sci\n#&gt;   &lt;chr&gt;                                                   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    \n#&gt; 1 PBS - (SLAMF6+ PD-1+ CD8+ cells)                   0.00000680 0      6.796e-06\n#&gt; 2 PBS - (SLAMF6- PD-1+ CD8+ cells)                   0.649      0.649  6.486e-01\n#&gt; 3 (SLAMF6+ PD-1+ CD8+ cells) - (SLAMF6- PD-1+ CD8+…  0.000103   0.0001 1.032e-04\n\np &lt;- f4h |&gt; summarise(\n    mean_volume = mean(volume),\n    sd = sd(volume),\n    .by = c(Days, method),) |&gt;\n    ggplot(aes(\n        x = Days,\n        y = mean_volume,\n        color = method,\n        group = method,)) +\n    geom_errorbar(\n        aes(ymin = mean_volume - sd, ymax = mean_volume + sd),\n        position = position_dodge(0),\n        width = .2,\n        linewidth = 0.5,\n    ) +\n    geom_line(position = position_dodge(0),\n              linewidth = 0.8) +\n    geom_point(\n        aes(shape = method),\n        position = position_dodge(0),\n        color = \"black\",\n        size = 2) +\n    theme_pubr() +\n    theme(legend.title = element_blank())\n\n# 使用ggplot_build()获取图层数据\nplot_data &lt;- ggplot_build(p)\n\n# 查看X轴的数值坐标\nplot_data$data\n#&gt; [[1]]\n#&gt;    colour       ymin      ymax x         y group PANEL flipped_aes      xmin\n#&gt; 1 #F8766D 21.2341315 29.640231 1 25.437181     1     1       FALSE 0.9666667\n#&gt; 2 #00BA38 29.8251093 42.689121 1 36.257115     2     1       FALSE 0.9666667\n#&gt; 3 #619CFF 23.2386460 36.902540 1 30.070593     3     1       FALSE 0.9666667\n#&gt; 4 #F8766D 20.3358912 49.648564 2 34.992228     1     1       FALSE 1.9666667\n#&gt; 5 #00BA38  4.8856152 11.577581 2  8.231598     2     1       FALSE 1.9666667\n#&gt; 6 #619CFF 22.3836755 39.057109 2 30.720392     3     1       FALSE 1.9666667\n#&gt; 7 #F8766D 28.7160676 66.995581 3 47.855824     1     1       FALSE 2.9666667\n#&gt; 8 #00BA38  0.5880804  5.165626 3  2.876853     2     1       FALSE 2.9666667\n#&gt; 9 #619CFF 27.2406302 48.369439 3 37.805035     3     1       FALSE 2.9666667\n#&gt;       xmax linewidth linetype width alpha\n#&gt; 1 1.033333       0.5        1   0.2    NA\n#&gt; 2 1.033333       0.5        1   0.2    NA\n#&gt; 3 1.033333       0.5        1   0.2    NA\n#&gt; 4 2.033333       0.5        1   0.2    NA\n#&gt; 5 2.033333       0.5        1   0.2    NA\n#&gt; 6 2.033333       0.5        1   0.2    NA\n#&gt; 7 3.033333       0.5        1   0.2    NA\n#&gt; 8 3.033333       0.5        1   0.2    NA\n#&gt; 9 3.033333       0.5        1   0.2    NA\n#&gt; \n#&gt; [[2]]\n#&gt;    colour x         y group PANEL flipped_aes xmin xmax      ymax linewidth\n#&gt; 1 #F8766D 1 25.437181     1     1       FALSE    1    1 25.437181       0.8\n#&gt; 2 #F8766D 2 34.992228     1     1       FALSE    2    2 34.992228       0.8\n#&gt; 3 #F8766D 3 47.855824     1     1       FALSE    3    3 47.855824       0.8\n#&gt; 4 #00BA38 1 36.257115     2     1       FALSE    1    1 36.257115       0.8\n#&gt; 5 #00BA38 2  8.231598     2     1       FALSE    2    2  8.231598       0.8\n#&gt; 6 #00BA38 3  2.876853     2     1       FALSE    3    3  2.876853       0.8\n#&gt; 7 #619CFF 1 30.070593     3     1       FALSE    1    1 30.070593       0.8\n#&gt; 8 #619CFF 2 30.720392     3     1       FALSE    2    2 30.720392       0.8\n#&gt; 9 #619CFF 3 37.805035     3     1       FALSE    3    3 37.805035       0.8\n#&gt;   linetype alpha\n#&gt; 1        1    NA\n#&gt; 2        1    NA\n#&gt; 3        1    NA\n#&gt; 4        1    NA\n#&gt; 5        1    NA\n#&gt; 6        1    NA\n#&gt; 7        1    NA\n#&gt; 8        1    NA\n#&gt; 9        1    NA\n#&gt; \n#&gt; [[3]]\n#&gt;   shape x         y group PANEL xmin xmax      ymax colour size fill alpha\n#&gt; 1    16 1 25.437181     1     1    1    1 25.437181  black    2   NA    NA\n#&gt; 2    17 1 36.257115     2     1    1    1 36.257115  black    2   NA    NA\n#&gt; 3    15 1 30.070593     3     1    1    1 30.070593  black    2   NA    NA\n#&gt; 4    16 2 34.992228     1     1    2    2 34.992228  black    2   NA    NA\n#&gt; 5    17 2  8.231598     2     1    2    2  8.231598  black    2   NA    NA\n#&gt; 6    15 2 30.720392     3     1    2    2 30.720392  black    2   NA    NA\n#&gt; 7    16 3 47.855824     1     1    3    3 47.855824  black    2   NA    NA\n#&gt; 8    17 3  2.876853     2     1    3    3  2.876853  black    2   NA    NA\n#&gt; 9    15 3 37.805035     3     1    3    3 37.805035  black    2   NA    NA\n#&gt;   stroke\n#&gt; 1    0.5\n#&gt; 2    0.5\n#&gt; 3    0.5\n#&gt; 4    0.5\n#&gt; 5    0.5\n#&gt; 6    0.5\n#&gt; 7    0.5\n#&gt; 8    0.5\n#&gt; 9    0.5\n\n\n\np  +  annotate(geom = \"segment\",\n               x = 3.4,\n               y = 47.855824,\n               yend = 2.876853,) + annotate(\n                   geom = \"text\",\n                   x = 3.45,\n                   y = (47.855824 + 2.876853) / 2,\n                   angle = 270,\n                   label = pvalue$padj[2],\n               ) +\n    annotate(geom = \"segment\",\n             x = 3.15,\n             y = 47.855824,\n             yend = 37.805035,) + annotate(\n                 geom = \"text\",\n                 x = 3.2,\n                 y = (47.855824 + 37.805035) / 2,\n                 angle = 270,\n                 label = pvalue$padj[1],\n             ) +\n    annotate(geom = \"segment\",\n             x = 3.3,\n             y = 2.876853,\n             yend = 37.805035,) + annotate(\n                 geom = \"text\",\n                 x = 3.35,\n                 y = (2.876853 + 37.805035) / 2,\n                 angle = 270,\n                 label = pvalue$padj[3],\n             )\n\n\n\n\n\n\nCode\n#y=c(47.855824,37.805035,2.876853,),\n#yend = c(2.876853,47.855824,37.805035,),\n\n\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/",
    "crumbs": [
      "图",
      "线图",
      "折线图"
    ]
  },
  {
    "objectID": "折线图.html#ggplot2-1",
    "href": "折线图.html#ggplot2-1",
    "title": "",
    "section": "\n3 ggplot2",
    "text": "3 ggplot2\n\nCodedf &lt;- ToothGrowth\ndf$dose &lt;- as.factor(df$dose)\n\nstat.test &lt;- df %&gt;%\n    group_by(dose) %&gt;%\n    t_test(len ~ supp) %&gt;%\n    adjust_pvalue(method = \"bonferroni\") %&gt;%\n    add_significance(\"p.adj\")\n\n\nlp &lt;- ggline(\n    df,\n    x = \"dose\",\n    y = \"len\",\n    add = \"mean_sd\",\n    color = \"supp\",\n    palette = c(\"#00AFBB\", \"#E7B800\")\n)\nlp\n\n\n\n\n\n\nCode# Add p-values onto the line plots\n# Remove brackets using linetype = \"blank\"\nstat.test &lt;- stat.test %&gt;%\n    add_xy_position(fun = \"mean_sd\", x = \"dose\")\nlp + stat_pvalue_manual(stat.test,\n                        label = \"p.adj.signif\",\n                        tip.length = 0,\n                        linetype  = \"blank\")",
    "crumbs": [
      "图",
      "线图",
      "折线图"
    ]
  },
  {
    "objectID": "Table.html",
    "href": "Table.html",
    "title": "",
    "section": "",
    "text": "Code\n\n\n\n\n\n表格\n三线表\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "表",
      "表格"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "",
    "section": "",
    "text": "Code\n\n\n\n\n这是R实现关于 articles 的图表的记录。\n作为速查电子笔记\nggpubr\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "dotplot.html",
    "href": "dotplot.html",
    "title": "",
    "section": "",
    "text": "点图点图 CodeShow All CodeHide All CodeView Source\n1 点图\n\nCodelibrary(tidyverse)\nlibrary(ggpubr)\nlibrary(readxl)\n\n\n\nCode\nf6d &lt;-\n    read_excel(\"data/01source.xlsx\", sheet = \"Fig.6\", range = \"D2:E18\")\nf6d |&gt; pivot_longer(\n    cols = everything(),\n    names_to = \"status\",\n    values_to = \"Ratio\",\n) |&gt; \n    tidyr::drop_na() -&gt;f6d\n\n\n\nCodeggdotplot(f6d,\n          x=\"status\",\n          y=\"Ratio\",\n          add =c(\"mean_sd\"),\n          color = \"status\",\n          fill = \"status\",\n          error.plot = \"errorbar\",\n)+\n    geom_signif(\n        comparisons = list(c(\"relapse\",\"non-relapse\")),\n    )+\n    ggplot2::annotate(\n        geom=\"segment\",\n        x=0.9,\n        xend=1.1,\n        y=2.42019873,#均值\n    )+\n    ggplot2::annotate(\n        geom=\"segment\",\n        x=1.9,\n        xend=2.1,\n        y=0.789463173,#均值\n    )\n#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with\n#&gt; `binwidth`.\n\n\n\n\n\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "图",
      "点图",
      "点图"
    ]
  },
  {
    "objectID": "Graph.html",
    "href": "Graph.html",
    "title": "",
    "section": "",
    "text": "Code\n\n\n\n\n\n图\n条图\n点图\n线图\n关系图\n十六进制颜色\n图像颜色提取器\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "图"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "参考文献",
    "section": "",
    "text": "https://www.nature.com/articles/s41467-023-43462-1\n\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "回归曲线.html",
    "href": "回归曲线.html",
    "title": "",
    "section": "",
    "text": "线图回归曲线 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "图",
      "线图",
      "回归曲线"
    ]
  },
  {
    "objectID": "回归曲线.html#简单线性回归",
    "href": "回归曲线.html#简单线性回归",
    "title": "",
    "section": "\n1.1 简单线性回归",
    "text": "1.1 简单线性回归\nR2 ,p值：f6c\n\nCodelibrary(tidyverse)\n\n\n\nCode# 示例数据\ndf &lt;- data.frame(\n  x = 1:100,\n  y = rnorm(100) + 2 * (1:100)  # 生成具有线性关系的x和y数据\n)\n\n# 创建基本的ggplot对象\np &lt;- ggplot(df, aes(x = x, y = y))+\n    geom_point(color='red')+\n    geom_smooth(method = \"lm\",formula = \"y~x\",color=\"black\",linewidth=.8)\n\n# 使用stat_poly_eq()添加线性回归方程、R²和p值\np + ggpmisc::stat_poly_eq(formula = y ~ x,\n                 ggpmisc::use_label(c(\"eq\", \"adj.R2\", \"P\")))\n#&gt; Registered S3 methods overwritten by 'ggpp':\n#&gt;   method                  from   \n#&gt;   heightDetails.titleGrob ggplot2\n#&gt;   widthDetails.titleGrob  ggplot2\n#&gt; Registered S3 method overwritten by 'ggpmisc':\n#&gt;   method                  from   \n#&gt;   as.character.polynomial polynom",
    "crumbs": [
      "图",
      "线图",
      "回归曲线"
    ]
  },
  {
    "objectID": "条图.html",
    "href": "条图.html",
    "title": "",
    "section": "",
    "text": "条图条图 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "图",
      "条图",
      "条图"
    ]
  },
  {
    "objectID": "条图.html#基础柱状图",
    "href": "条图.html#基础柱状图",
    "title": "",
    "section": "\n1.1 基础柱状图",
    "text": "1.1 基础柱状图\n\nCodeggplot(df,aes(supp,len))+\n    geom_col()\n\n\n\n\n\n\nCode\nggplot(df,aes(supp,len))+\n    geom_bar(stat = \"identity\")",
    "crumbs": [
      "图",
      "条图",
      "条图"
    ]
  },
  {
    "objectID": "条图.html#修改边框和填充颜色",
    "href": "条图.html#修改边框和填充颜色",
    "title": "",
    "section": "\n1.2 修改边框和填充颜色",
    "text": "1.2 修改边框和填充颜色\n\nCodeggplot(df,aes(id,len,color=factor(dose)))+\n    geom_col(fill=NA)",
    "crumbs": [
      "图",
      "条图",
      "条图"
    ]
  },
  {
    "objectID": "条图.html#添加标签",
    "href": "条图.html#添加标签",
    "title": "",
    "section": "\n1.3 添加标签",
    "text": "1.3 添加标签\n\nCodeggplot(df,aes(id,len))+\n    geom_col()+\n   ggrepel::geom_text_repel(aes(y=len+3,label=len))",
    "crumbs": [
      "图",
      "条图",
      "条图"
    ]
  },
  {
    "objectID": "条图.html#添加散点抖动点",
    "href": "条图.html#添加散点抖动点",
    "title": "",
    "section": "\n1.4 添加散点、抖动点",
    "text": "1.4 添加散点、抖动点\n\nCodeggplot(mpg, aes(x = drv, y = hwy, fill = as.factor(cyl))) +  \n    geom_bar(stat = \"summary\",fun=mean, position = position_dodge(1)) +\n    stat_summary(fun.data = 'mean_sd',geom=\"errorbar\",position = position_dodge(1),\n                 width=.2,linewidth=1)+\n    geom_point(position = position_dodge(1), \n              size = 3,alpha=0.3\n             )  \n\n\n\n\n\n\n\n\nCodedf &lt;- ToothGrowth\nggplot(df, aes(x = supp, y = len)) +\n    geom_bar(\n        aes(fill = factor(dose)),\n        stat = \"summary\",\n        fun = mean,\n        position = position_dodge(width = 0.9)\n    ) +\n    geom_point(position = position_jitterdodge(jitter.width = 0.1),\n               aes(color = factor(dose)),\n               alpha = 0.7)+\n    scale_color_manual(values = c(\"red\",\"green\",\"blue\"))|\n    ggplot(df, aes(x = supp, y = len)) +\n    geom_bar(\n        aes(fill = factor(dose)),\n        stat = \"summary\",\n        fun = mean,\n        position = position_dodge(width = 0.9)\n    ) +\n    geom_dotplot(position = position_dodge(width = 0.9),\n               aes(fill = factor(dose)),dotsize = 0.8,\n               binaxis = \"y\", stackdir = \"center\",color=\"black\",\n               alpha = 0.7)+\n    scale_fill_manual(values = c(\"red\",\"green\",\"blue\"))\n#&gt; Bin width defaults to 1/30 of the range of the data. Pick better value with\n#&gt; `binwidth`.",
    "crumbs": [
      "图",
      "条图",
      "条图"
    ]
  },
  {
    "objectID": "条图.html#分组排序条图-waterfall-barplot",
    "href": "条图.html#分组排序条图-waterfall-barplot",
    "title": "",
    "section": "\n1.5 分组排序条图 waterfall barplot",
    "text": "1.5 分组排序条图 waterfall barplot\n\nCodelibrary(tidyverse)\nlibrary(ggpubr)\nlibrary(ggsci)\nlibrary(readxl)\nc &lt;- read_excel(\"data/01source.xlsx\",sheet=1,range = \"A2:D16\") |&gt; \n  rename(\n    LR_DPVB=`LR-DPVB`\n  )  |&gt; \n  pivot_longer(\n    cols = CON:LR_DPVB,\n    names_to = \"treatment\",\n    values_to = \"changerate\"\n  ) |&gt; \n  mutate(\n    treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB')),\n    changerate=if_else(changerate&gt;=1,100,changerate*100)\n  ) |&gt; \n  arrange(treatment)|&gt;\n  drop_na() |&gt; \n  mutate(\n    id=1:52\n    ) \n\n\n\nCode\nggplot( c ,aes(x=id,y=changerate,fill=treatment))+ \n  geom_bar(stat = \"identity\",position = \"dodge\",width =0.8)+\n    scale_fill_jco()+\n    scale_y_continuous(name = \"MRI tumor volume change from baseline (%)\",\n                       limits = c(-100,100),\n                       breaks = seq(-100,100,50),\n                       )+\n    theme_pubr()+\n    theme(\n        legend.position = c(0.8,0.8),\n        legend.title = element_blank(),\n        axis.title.x = element_blank(),\n        axis.text.x = element_blank(),\n        axis.ticks.x = element_blank(),\n        axis.line.x = element_blank(),\n        plot.title = element_text(hjust = 0.5),\n    )+\n    ggtitle(\"Hepa1-6 tumor\")+\n    geom_hline(yintercept = 0,color = \"black\",linetype =1,linewidth=0.8)+\n    geom_hline(yintercept=c(20,-30), colour=\"gray15\", linetype=3,linewidth=0.8)+                # 0 = blank, 1 = solid, 2 = dashed, 3 = dotted, \n            # 4 = dotdash, 5 = longdash, 6 = twodash\n    annotate(geom = \"text\",x=c(2,50),y=c(-30,20),\n             label = c(\"PR:-30%\",\"PD:20%\"),\n             vjust = -0.5,\n             )   \n#&gt; Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2\n#&gt; 3.5.0.\n#&gt; ℹ Please use the `legend.position.inside` argument of `theme()` instead.",
    "crumbs": [
      "图",
      "条图",
      "条图"
    ]
  },
  {
    "objectID": "条图.html#分组条形图添加-errorbarsignificance-dotplot",
    "href": "条图.html#分组条形图添加-errorbarsignificance-dotplot",
    "title": "",
    "section": "\n1.6 分组条形图添加 errorbar、significance 、dotplot",
    "text": "1.6 分组条形图添加 errorbar、significance 、dotplot\n\nCodeg&lt;-read_excel(\"data/01source.xlsx\",sheet=1,range=\"G2:Z3\") \n#&gt; New names:\n#&gt; • `` -&gt; `...2`\n#&gt; • `` -&gt; `...3`\n#&gt; • `` -&gt; `...4`\n#&gt; • `` -&gt; `...5`\n#&gt; • `` -&gt; `...7`\n#&gt; • `` -&gt; `...8`\n#&gt; • `` -&gt; `...9`\n#&gt; • `` -&gt; `...10`\n#&gt; • `` -&gt; `...12`\n#&gt; • `` -&gt; `...13`\n#&gt; • `` -&gt; `...14`\n#&gt; • `` -&gt; `...15`\n#&gt; • `` -&gt; `...17`\n#&gt; • `` -&gt; `...18`\n#&gt; • `` -&gt; `...19`\n#&gt; • `` -&gt; `...20`\ncolnames(g) &lt;- rep(c('CON','LDRT','DPVB','LR_DPVB'),each=5)\ng&lt;- g |&gt;  pivot_longer(\n  cols = everything(),\n  names_to = \"treatment\",\n  values_to = \"liverweight\"\n  )|&gt; \n  mutate(\n    treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB'))\n  )\ng\n#&gt; # A tibble: 20 × 2\n#&gt;    treatment liverweight\n#&gt;    &lt;fct&gt;           &lt;dbl&gt;\n#&gt;  1 CON              1.75\n#&gt;  2 CON              1.8 \n#&gt;  3 CON              2.01\n#&gt;  4 CON              1.52\n#&gt;  5 CON              1.63\n#&gt;  6 LDRT             1.73\n#&gt;  7 LDRT             2.05\n#&gt;  8 LDRT             1.48\n#&gt;  9 LDRT             1.66\n#&gt; 10 LDRT             1.68\n#&gt; 11 DPVB             1.2 \n#&gt; 12 DPVB             1.38\n#&gt; 13 DPVB             1.52\n#&gt; 14 DPVB             1.62\n#&gt; 15 DPVB             1.39\n#&gt; 16 LR_DPVB          1.2 \n#&gt; 17 LR_DPVB          1.23\n#&gt; 18 LR_DPVB          1.13\n#&gt; 19 LR_DPVB          1.03\n#&gt; 20 LR_DPVB          0.89\n\n\n\nCodesource(\"function/calculate_t_tests.R\")\ncalculate_t_tests(g,\"treatment\",\"liverweight\")\n#&gt;                  CON         LDRT        DPVB LR_DPVB\n#&gt; CON               NA           NA          NA      NA\n#&gt; LDRT    0.8639404014           NA          NA      NA\n#&gt; DPVB    0.0193695457 0.0359059495          NA      NA\n#&gt; LR_DPVB 0.0003376202 0.0008265681 0.008820249      NA\n\n\n\n\n\n\n\n\nNote\n\n\n\n函数calculate_t_tests\n\nCode# 定义计算两两组之间t检验的函数\ncalculate_t_tests &lt;- function(data, group_by, value_column) {\n  # data: 数据框\n  # group_by: 组别的列名\n  # value_column: 要比较的数值的列名\n  \n  # 提取唯一的组别\n  groups &lt;- unique(data[[group_by]])\n  \n  # 初始化结果矩阵\n  result_matrix &lt;- matrix(NA, nrow = length(groups), ncol = length(groups),\n                          dimnames = list(groups, groups))\n  \n  # 循环遍历所有可能的组合\n  for (i in 1:(length(groups)-1)) {\n    for (j in (i+1):length(groups)) {\n      # 提取两组数据\n      group1_data &lt;- data[data[[group_by]] == groups[i], value_column]\n      group2_data &lt;- data[data[[group_by]] == groups[j], value_column]\n      \n      # 执行t检验\n      t_test_result &lt;- t.test(group1_data, group2_data)\n      \n      # 提取p值\n      p_value &lt;- t_test_result$p.value\n      \n      # 将p值存入结果矩阵\n      #result_matrix[groups[i], groups[j]] &lt;- p_value\n      result_matrix[groups[j], groups[i]] &lt;- p_value\n    }\n  }\n  \n  # 返回结果矩阵\n  return(result_matrix)\n}\n\n\n\n\n\n1.6.1 ggpubr\n\nCodelibrary(ggpubr)\nggbarplot(data = g,\n          x=\"treatment\",y=\"liverweight\",\n          add = c(\"mean_sd\"),\n          fill = \"treatment\",\n          palette = \"jco\",\n          title = \"DEN+CCl4 tumor\",\n          xlab = \"\",\n          ylab='liver weight (g)',\n          legend='none',\n          )+\n  stat_compare_means(\n      #aes(label='p.format'),\n      comparisons = list(c('CON','LDRT'),c(\"DPVB\",'LR_DPVB'), c(\"CON\",\"LR_DPVB\")),\n      method = 't.test',\n      tip.length = c(0,0,0,0,0,0),\n      bracket.size = 1,linewidth=1)+\n\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.text.x = element_text(angle = 45,vjust = 0.5))+\n  geom_dotplot(data = g,\n               mapping=aes(x=treatment,y=liverweight),\n               binaxis = 'y',stackdir = 'center',binwidth = 0.05)\n\n\n\n\n\n\n\n\n1.6.2 ggplot2+ggsignif\n\nCodelibrary(ggsignif)\ng |&gt; \n  summarise(\n    n=n(),\n    mean=mean(liverweight),\n    sd=sd(liverweight),\n    .by=treatment\n  ) |&gt; \n    ggplot(aes(treatment,mean,fill=treatment))+\n    geom_bar(stat = \"identity\",width = .7,position = position_dodge())+#条形图\n    geom_errorbar(aes(ymin=mean-sd,ymax=mean+sd),\n                  width=.2,color=\"black\",linewidth=.8)+#误差棒\n    geom_signif(data = g,\n              mapping=aes(x=treatment,y=liverweight),\n              comparisons = list(c('CON','LDRT'),c(\"DPVB\",'LR_DPVB'),\n                                 c(\"CON\",\"LR_DPVB\")),\n              annotations = c(\"p=0.8639\",\"p=0.0088\",\"p=0.00034\"),\n              map_signif_level=F,\n              tip_length=c(0.0,0.0,0.0,0.0,0.0,0.0),\n              y_position=c(2.1,1.8,2.35),size = .8,\n              textsize = 5,\n              test = \"t.test\"\n              )+\n    theme_pubr()+\n    scale_fill_jco()+\n    scale_y_continuous(limits = c(0,2.5))+\n    labs(\n        x='',\n        y='liver weight (g)',\n        title=\"DEN+CCl4 tumor\"\n    )+\n    theme(\n        plot.title = element_text(hjust =0.5 ),\n        legend.position = 'none',\n        axis.text.x = element_text(angle = 45,vjust = .5)\n    )+  \n    geom_dotplot(data = g,\n                 mapping=aes(x=treatment,y=liverweight),\n                 binaxis = 'y',\n                 stackdir = 'center',#居中\n                 fill='black',\n                 binwidth = 0.05)\n#&gt; Warning in geom_signif(data = g, mapping = aes(x = treatment, y = liverweight),\n#&gt; : You have set data and mapping, are you sure that manual = FALSE is correct?\n\n\n\n\n\n\n\n\n1.6.3 分组并列，组内显著性p值\nhttps://www.datanovia.com/en/blog/tag/ggpubr/\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/\n\nCodef2e &lt;- read_excel(\"data/01source.xlsx\", sheet = 3, range = \"A2:M4\")\n#&gt; New names:\n#&gt; • `` -&gt; `...3`\n#&gt; • `` -&gt; `...4`\n#&gt; • `` -&gt; `...6`\n#&gt; • `` -&gt; `...7`\n#&gt; • `` -&gt; `...9`\n#&gt; • `` -&gt; `...10`\n#&gt; • `` -&gt; `...12`\n#&gt; • `` -&gt; `...13`\ncolnames(f2e) &lt;-\n    c(\"type\", rep(c('CON', 'LDRT', 'DPVB', 'LR_DPVB'), each = 3))\n\nf2e |&gt; pivot_longer(cols = -1,\n                    names_to = \"trt\",\n                    values_to = \"pct\",\n) |&gt;\n    mutate(trt = factor(trt, levels = c('CON', 'LDRT', 'DPVB', 'LR_DPVB'))) -&gt; f2e\n\n\n\nCodelibrary(ggpubr)\nlibrary(rstatix)\n\nstat.test &lt;- f2e %&gt;%\n  group_by(type) %&gt;%\n  t_test(pct ~ trt) |&gt; \n  adjust_pvalue(method = \"bonferroni\") %&gt;%\n    add_significance(\"p.adj\") |&gt; \n    add_significance(\"p\") \n\n\nstat.test &lt;- stat.test %&gt;%\n  add_xy_position(fun = \"mean_sd\", x = \"type\", dodge = 1)|&gt; \n  dplyr::filter(group1==\"CON\"&group2==\"LR_DPVB\")\n\n\ne_left &lt;- ggbarplot(f2e, x = \"type\", y = \"pct\",\n                fill = \"trt\", palette = \"jco\",\n                add =c(\"mean_sd\"), add.params = list(group = \"trt\"),\n                position = position_dodge(1),\n                #legend=\"none\",\n          legend.title=\"\",\n          )+\n    scale_y_continuous(limits = c(0,80))+\n    stat_pvalue_manual(\n        data = stat.test,\n        label = \"p={p}({p.signif})\",\n        tip.length = 0.05,\n        y.position = c(40,75),\n        #bracket.nudge.y = -2,\n)+labs(\n        x='',\n        y='% in live CD45+ cell',\n        #title=\"Hepa1-6 tumor\"\n    )\n\ne_right &lt;- e_left\n\nlibrary(patchwork)\n(e_left + e_right)+\n    plot_annotation(\n        title = \"Hepa1-6 tumor\",\n    ) +\n    plot_layout(guides = \"collect\")& \n    theme(\n        plot.title = element_text(hjust = 0.5),\n        legend.position = \"top\",\n    )\n\n\n\n\n\n\n\n\n1.6.4 分组并列，组内组间显著性p值\nhttps://www.datanovia.com/en/blog/how-to-add-p-values-onto-a-grouped-ggplot-using-the-ggpubr-r-package/\n\nCodelibrary(ggpubr)\nlibrary(rstatix)\ndf &lt;- ToothGrowth\ndf$dose &lt;- as.factor(df$dose)\n\n\n\nbp &lt;- ggbarplot(\n    df,\n    x = \"dose\",\n    y = \"len\",\n    add = \"mean_sd\",\n    color = \"supp\",\n    palette = c(\"#00AFBB\", \"#E7B800\"),\n    position = position_dodge(0.8)\n)\n\n\n# 统计检验\nstat.test &lt;- df %&gt;%\n    group_by(dose) %&gt;%\n    t_test(len ~ supp) %&gt;%\n    adjust_pvalue(method = \"bonferroni\") %&gt;%\n    add_significance(\"p.adj\")\nstat.test &lt;- stat.test %&gt;%\n    add_xy_position(fun = \"mean_sd\", x = \"dose\", dodge = 0.8)\n\n\nstat.test2 &lt;- df %&gt;%\n    t_test(len ~ dose, p.adjust.method = \"bonferroni\")\nstat.test2 &lt;- stat.test2 %&gt;%\n    add_xy_position(x = \"dose\")\n\npwc &lt;- df %&gt;%\n    group_by(supp) %&gt;%\n    t_test(len ~ dose, p.adjust.method = \"bonferroni\")\npwc\n#&gt; # A tibble: 6 × 11\n#&gt;   supp  .y.   group1 group2    n1    n2 statistic    df            p      p.adj\n#&gt; * &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;\n#&gt; 1 OJ    len   0.5    1         10    10     -5.05  17.7 0.0000878    0.000263  \n#&gt; 2 OJ    len   0.5    2         10    10     -7.82  14.7 0.00000132   0.00000396\n#&gt; 3 OJ    len   1      2         10    10     -2.25  15.8 0.039        0.118     \n#&gt; 4 VC    len   0.5    1         10    10     -7.46  17.9 0.000000681  0.00000204\n#&gt; 5 VC    len   0.5    2         10    10    -10.4   14.3 0.0000000468 0.00000014\n#&gt; 6 VC    len   1      2         10    10     -5.47  13.6 0.0000916    0.000275  \n#&gt; # ℹ 1 more variable: p.adj.signif &lt;chr&gt;\npwc &lt;- pwc %&gt;%\n    add_xy_position(\n        x = \"dose\",\n        fun = \"mean_sd\",\n        group = \"supp\",\n        dodge = 0.8\n    )\n\n# 组间组内复合\n\n\nbp +\n    stat_pvalue_manual(stat.test,  label = \"p.adj.signif\", tip.length = 0.01) +\n    stat_pvalue_manual(\n        stat.test2,\n        label = \"p\",\n        tip.length = 0.02,\n        step.increase = 0.05\n    ) +\n    scale_y_continuous(expand = expansion(mult = c(0.05, 0.1))) +\n    stat_pvalue_manual(\n        pwc,\n        color = \"supp\",\n        step.group.by = \"supp\",\n        tip.length = 0,\n        step.increase = 0.1\n    )",
    "crumbs": [
      "图",
      "条图",
      "条图"
    ]
  },
  {
    "objectID": "生存曲线.html",
    "href": "生存曲线.html",
    "title": "",
    "section": "",
    "text": "线图生存曲线 CodeShow All CodeHide All CodeView Source",
    "crumbs": [
      "图",
      "线图",
      "生存曲线"
    ]
  },
  {
    "objectID": "生存曲线.html#kaplan-meier-curve",
    "href": "生存曲线.html#kaplan-meier-curve",
    "title": "",
    "section": "\n1.1 Kaplan-Meier curve",
    "text": "1.1 Kaplan-Meier curve\n\nCodelibrary(tidyverse)\nlibrary(readxl)\n\n\n\nCode### 数据 三列 “group”分组列， “time”生存时间列，“status”事件状态列\nd&lt;-read_excel(\"data/01source.xlsx\",sheet=1,range = \"A19:E75\") |&gt; \n    rename(\n        LR_DPVB=`LR-DPVB`\n    )  |&gt; \n    pivot_longer(\n        cols = CON:LR_DPVB,\n        names_to = \"treatment\",\n        values_to = \"status\"\n    ) |&gt; drop_na() |&gt; \n    mutate(\n        treatment=factor(treatment,levels=c('CON','LDRT','DPVB','LR_DPVB'))\n    )\n# 加载包\nlibrary(survival)\n\n# 使用 Kaplan-Meier 方法拟合生存曲线\nkm_fit&lt;-survfit(Surv(Days,status)~treatment,data=d)\nsummary(km_fit)\n#&gt; Call: survfit(formula = Surv(Days, status) ~ treatment, data = d)\n#&gt; \n#&gt;                 treatment=CON \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    11     14       1   0.9286  0.0688       0.8030        1.000\n#&gt;    13     13       1   0.8571  0.0935       0.6921        1.000\n#&gt;    14     12       2   0.7143  0.1207       0.5129        0.995\n#&gt;    15     10       1   0.6429  0.1281       0.4351        0.950\n#&gt;    17      9       3   0.4286  0.1323       0.2341        0.785\n#&gt;    20      6       2   0.2857  0.1207       0.1248        0.654\n#&gt;    21      4       2   0.1429  0.0935       0.0396        0.515\n#&gt;    25      2       1   0.0714  0.0688       0.0108        0.472\n#&gt;    27      1       1   0.0000     NaN           NA           NA\n#&gt; \n#&gt;                 treatment=LDRT \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    13     14       2   0.8571  0.0935       0.6921        1.000\n#&gt;    15     12       1   0.7857  0.1097       0.5977        1.000\n#&gt;    16     11       1   0.7143  0.1207       0.5129        0.995\n#&gt;    18     10       1   0.6429  0.1281       0.4351        0.950\n#&gt;    19      9       2   0.5000  0.1336       0.2961        0.844\n#&gt;    20      7       3   0.2857  0.1207       0.1248        0.654\n#&gt;    24      4       1   0.2143  0.1097       0.0786        0.584\n#&gt;    25      3       1   0.1429  0.0935       0.0396        0.515\n#&gt;    27      2       1   0.0714  0.0688       0.0108        0.472\n#&gt;    30      1       1   0.0000     NaN           NA           NA\n#&gt; \n#&gt;                 treatment=DPVB \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    20     14       1    0.929  0.0688        0.803        1.000\n#&gt;    23     13       1    0.857  0.0935        0.692        1.000\n#&gt;    27     12       1    0.786  0.1097        0.598        1.000\n#&gt;    28     11       1    0.714  0.1207        0.513        0.995\n#&gt;    30     10       1    0.643  0.1281        0.435        0.950\n#&gt;    32      9       1    0.571  0.1323        0.363        0.899\n#&gt;    38      8       1    0.500  0.1336        0.296        0.844\n#&gt;    39      7       1    0.429  0.1323        0.234        0.785\n#&gt;    45      6       1    0.357  0.1281        0.177        0.721\n#&gt; \n#&gt;                 treatment=LR_DPVB \n#&gt;  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n#&gt;    30     14       1    0.929  0.0688        0.803            1\n#&gt;    40     13       1    0.857  0.0935        0.692            1",
    "crumbs": [
      "图",
      "线图",
      "生存曲线"
    ]
  },
  {
    "objectID": "生存曲线.html#plot",
    "href": "生存曲线.html#plot",
    "title": "",
    "section": "\n1.2 plot()\n",
    "text": "1.2 plot()\n\n\nCodeplot(km_fit,\n     lty = 1,\n     col = c(\"gray\",\"blue\",\"orange3\",\"darkred\"),\n     lwd = 2,\n)",
    "crumbs": [
      "图",
      "线图",
      "生存曲线"
    ]
  },
  {
    "objectID": "生存曲线.html#ggsurvplot",
    "href": "生存曲线.html#ggsurvplot",
    "title": "",
    "section": "\n1.3 ggsurvplot()\n",
    "text": "1.3 ggsurvplot()\n\n\nCode# 使用 ggplot2 和 survminer 绘制生存曲线图\nlibrary(survminer)\n#&gt; Loading required package: ggpubr\nggsurvplot(\n    fit  = km_fit,\n    data = d,\n    fun = \"pct\",  #event',累计死亡比列，'cumhaz':cumulative hazard累计风险\n    \n    palette = \"jco\",\n    linetype = c(1,5,4,6),\n    surv.median.line = 'none',\n    \n    conf.int = TRUE,\n    conf.int.alpha=0.5,\n    \n    pval = TRUE,# \"log rank p=0.0053\"\n    log.rank.weights='1',  \n    pval.method = TRUE,\n    pval.coord=c(40,75),\n    pval.method.coord=c(35,75),\n    \n    risk.table = \"abs_pct\", # \"nrisk_cumcensor\" and \"nrisk_cumevents\"\n    risk.table.col = \"treatment\",\n    tables.theme = theme_cleantable(),\n    ncensor.plot=T,\n    \n    \n    axes.offset=F,  #(0,0)pos\n    title = \"Hepa1-6 tumor\",\n    xlab=\"Days\",\n    ylab=\"Percent survival (%)\",\n    \n    legend.title = \"\",\n    legend = c(0.2,0.35),\n    legend.labs=c('CON','LDRT','DPVB','LR_DPVB'),\n    \n    ggtheme = theme_survminer(),\n)",
    "crumbs": [
      "图",
      "线图",
      "生存曲线"
    ]
  }
]